
\section{Pascal characterization}

In this section we present some results about Pascal array and
its inverse, taken modulo some prime $p$. 

Associating different colours to elements belonging to different remainder
classes, we show formally that for $p$ even, ie. $p=2$, elements in the same
position get the same colour, hence both triangles are coloured in the same
way, ignoring signs for elements in the inverse array, which can happen to be
negative. On the other hand, for $p$ odd there is not such a simple
correspondence and we attempt to observe some repeating pattern in the mapping
among elements in those arrays.

\subsection{$\equiv_{p}$ over $\mathcal{P}$ and $\mathcal{P}^{-1}$,
    where $p$ \emph{is} a prime}

Let $\mathcal{P}$ be the Riordan array for the Pascal triangle,
defined as:
\begin{displaymath} 
    \mathcal{P} = \left(\frac{1}{1-t}, \frac{t}{1-t}  \right)
\end{displaymath} 
and let $\mathcal{P}^{-1}$ be the inverse of $\mathcal{P}$:
\begin{displaymath} 
    \mathcal{P}^{-1} = \left(\frac{1}{1+t}, \frac{t}{1+t}  \right)
\end{displaymath} 

Let $d_{nk}$ and $\hat{d}_{nk}$ be the generic elements of $\mathcal{P}$ and of
$\mathcal{P}^{-1}$, respectively. Since both arrays are in the Riordan group,
$d_{nk}$ can be written as:
\begin{displaymath}
    \begin{split}
        d_{nk} &= [t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k = [t^{n-k}](1-t)^{-(k+1)} \\
            &= {{-(k+1)} \choose {n-k}}(-1)^{n-k} = {{k+1 +n-k -1} \choose {n-k}} = {{n} \choose {n-k}} \\
    \end{split}
\end{displaymath}
using the same approach $\hat{d}_{nk}$ can be written as:
\begin{displaymath}
  \begin{split}
    \hat{d}_{nk} &= [t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k = [t^{n-k}](1+t)^{-(k+1)} = 
    {{-(k+1)} \choose {n-k}} \\
    &= {{k+1 +n-k -1} \choose {n-k}} (-1)^{n-k} = {{n} \choose {n-k}} (-1)^{n-k}\\
  \end{split}
\end{displaymath}
Hence, equating binomial coefficients yields:
\begin{displaymath}
  [t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k = (-1)^{k-n}[t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k 
\end{displaymath}
Choose a prime $p$ and apply the modulo operator on both members:
\begin{displaymath}
  [t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k \equiv_{p} (-1)^{k-n}[t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k 
\end{displaymath}


\marginpar{$b^{-1}\mod p$ exists if and only if $(b,p)=1$} From now on we have
to reason according to modular arithmetic, in particular we have to keep in mind
that multiplying by a term $a$ both member of an equation for the sake of
simplification a term $b$, requests to show that $a$ is the
\emph{multiplicative inverse} of $b$ modulo $p$, denoted by: 
\begin{displaymath}
    a = b^{-1}\mod p
\end{displaymath}

First of all, observe that $-1 \equiv_{p} p-1$ and since $p$ is a
prime by hp, it follows that $(p, p-1)=1$ (this result holds in
general, not just for $p$ prime), which proofs the existence of
both $-1$ and $p-1$ inverses, denoted by $(-1)^{-1}\mod p$ and
$(p-1)^{-1}\mod p$ respectively.

In order to find $(p-1)^{-1}\mod p$ we have to satisfy the
congruence equation $(p-1) \cdot (p-1)^{-1} \equiv_{p} 1$. Choose
$(p-1)^{-1}\mod p = p-1$ and verify
$(p-1) \cdot (p-1) \equiv_{p} p^{2} -2\,p +1 \equiv_{p} 1$ as required.

Another useful observation concerns raising to negative powers:
\begin{displaymath}
    (-1)^{-k} \equiv_{p} \left((-1)^{-1}\right)^{k} \equiv_{p} (p-1)^k
\end{displaymath}
where $k \geq 0$ and, since $-1 \equiv_{p} p-1$, it follows that
$(-1)^{-k} \equiv_{p} (-1)^k$.

Now we can use previous observation on the main congruence:
\begin{displaymath}
    \begin{split}
        [t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k 
            &\equiv_{p} (-1)^{k-n}[t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k \\
            &\equiv_{p} (-1)^{k+n}[t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k \\
            &\equiv_{p} (p-1)^{k+n}[t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k \\
    \end{split}
\end{displaymath}
Hence, multiplying by $(p-1)^{-1}\mod p$ both members $k+n$ times:
\begin{displaymath}
    (p-1)^{k+n}[t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k \equiv_{p} [t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k 
\end{displaymath}
which is the same as:
\begin{displaymath}
    (-1)^{k+n}[t^n]\frac{1}{1-t}\left(\frac{t}{1-t}\right)^k \equiv_{p} [t^n]\frac{1}{1+t}\left(\frac{t}{1+t}\right)^k 
\end{displaymath}
and relating generic elements $d_{nk}$ and $\hat{d}_{nk}$:
\marginpar{a general congruence $\equiv_{p}$ over $\mathcal{P}$ and $\mathcal{P}^{-1}$, where $p$
    is an arbitrary prime}
\begin{equation}
    \label{eq:general:congruence:over:pascal:arrays}
    (p-1)^{k+n}d_{nk}\equiv_{p}(-1)^{k+n}d_{nk} \equiv_{p} \hat{d}_{nk}
\end{equation}

\subsection{$\mathcal{P}_{\equiv_{2}}$} 

The case where $p$ is the even prime produces the colouring reported in
\autoref{fig:pascal-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-triangle} for $\mathcal{P}$,
and the colouring reported in
\autoref{fig:pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-triangle} for $\mathcal{P}^{-1}$,
where negatives entries are ignored, while in 
\autoref{fig:pascal-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-triangle} such entries are handled.
Formally, $\mathcal{P}$ and $\mathcal{P}^{-1}$ look the same because if we fix $p=2$, 
\autoref{eq:general:congruence:over:pascal:arrays} yields:
\begin{displaymath} 
    d_{nk} \equiv_{2} \hat{d}_{nk} 
\end{displaymath} 
for any choice of $n$ and $k$ in $\mathbb{N}$.

\input{Chapters/mod-p-characterization/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
\input{Chapters/mod-p-characterization/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
\input{Chapters/mod-p-characterization/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
\input{Chapters/mod-p-characterization/pascal/pascal-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}


\subsection{$\mathcal{P}_{\equiv_{3}}$}

Here there's a more interesting pattern to study, and in general,
for any odd prime $p$, colourings of $\mathcal{P}$ and its inverse 
mismatch. In this section we tackle the case for $p=3$,
instantiating \autoref{eq:general:congruence:over:pascal:arrays} yields:
\begin{displaymath}
  2^{k+n}d_{nk}\equiv_{3}(-1)^{k+n}d_{nk} \equiv_{3} \hat{d}_{nk}
\end{displaymath}

For the sake of clarity, let us consider row $4$ of both triangles:
\begin{itemize}
\item $\mathcal{P}_{[3,\,:]} = (1 \quad 3 \quad 3 \quad 1) \equiv_{3}(1 \quad 0 \quad 0 \quad 1)$
\item $\mathcal{P}^{-1}_{[3,\,:]} = (-1 \quad 3 \quad -3 \quad 1) \equiv_{3}(2 \quad 0 \quad 0 \quad 1)$
\end{itemize}
\marginpar{$[\alpha,\beta]$
 in $\mathcal{R}_{[\alpha,\beta]}$ is the \emph{slice operator}, 
 where $\alpha,\beta\in\mathbb{Z}\cup\lbrace:\rbrace$, as defined in NumPy or in Octave}
Hence element $d_{30}$ gets a color $c$ while $\hat{d}_{30}$ gets
a color $c'$ different from $c$: no general mapping about this relationship appears, so we
study the two coloured triangles carefully. 

Our exercise here is as follow: first fix the order $\alpha$ of a principal
cluster $\mathcal{P}^{(\alpha)}$, say $\alpha=4$; then move upwards from the
last row of $\mathcal{P}^{(4)}$ to the top, one row by one, repeatedly. For
each considered row, move toward the right over columns, trying to understand a
possible congruence over coefficients in the two arrays, see
\autoref{fig:pascal:standard:mod3:congruence:zero:row:above}
for some highlights:
\input{Chapters/mod-p-characterization/pascal/pascal-standard-mod3-zero-row-above-end-include-figure}
\begin{displaymath}
    \begin{split}
        d_{3^4 -1,0} &\equiv_{3} \hat{d}_{3^4 -1,0} \\
        d_{3^4 -1,1} &\equiv_{3} \hat{d}_{3^4 -2,0} \\
        d_{3^4 -1,2} &\equiv_{3} \hat{d}_{3^4 -3,0} \\
        d_{3^4 -1,3} &\equiv_{3} \hat{d}_{3^4 -4,0} \\
        &\vdots
    \end{split}
\end{displaymath}
next, a congruence going up one row:
\marginpar{remember that the last row of $\mathcal{P}^{(\alpha)}$ is $p^{\alpha}-1$,
    for $p$ given }
\begin{displaymath}
    \begin{split}
        d_{3^4 -2,0} &\equiv_{3} \hat{d}_{3^4 -1,1} \\
        d_{3^4 -2,1} &\equiv_{3} \hat{d}_{3^4 -2,1} \\
        d_{3^4 -2,2} &\equiv_{3} \hat{d}_{3^4 -3,1} \\
        d_{3^4 -2,3} &\equiv_{3} \hat{d}_{3^4 -4,1} \\
        &\vdots
    \end{split}
\end{displaymath}
next, a congruence going up two rows:
\begin{displaymath}
    \begin{split}
        d_{3^4 -3,0} &\equiv_{3} \hat{d}_{3^4 -1,2} \\
        d_{3^4 -3,1} &\equiv_{3} \hat{d}_{3^4 -2,2} \\
        d_{3^4 -3,2} &\equiv_{3} \hat{d}_{3^4 -3,2} \\
        d_{3^4 -3,3} &\equiv_{3} \hat{d}_{3^4 -4,2} \\
        &\vdots
    \end{split}
\end{displaymath}

A structure over indices can be caught, so let us introduce variable
$b\in\lbrace1,\ldots,3^{4}\rbrace$ running over rows, and variable
$a\in\lbrace 0,\ldots,3^{4}-b\rbrace$, running over columns. So we can state the following 
congruence:
\begin{equation}
    \label{eq:pascal:arrays:congruence:rows:cols}
    d_{3^4 -b,a} \equiv_{3} \hat{d}_{3^4 -1-a,b-1} 
\end{equation}
\marginpar{column segments of $\mathcal{P}$ are congruent to row segment of
    $\mathcal{P}^{-1}$ and viceversa}

Let's say, assume the colouring for $\mathcal{P}^{-1}$ triangle is
given and the colouring for row $26$ of $\mathcal{P}$ is desired. It
is necessary to find $b$: by $3^4 -b=26$ get $b=55$, so the
coefficients lying on the required row satisfy the following congruence:
\begin{displaymath}
        d_{26,a} \equiv_{3} \hat{d}_{80-a,54} 
\end{displaymath}
\input{Chapters/mod-p-characterization/pascal/pascal-standard-mod3-zero-row-26-include-figure}
an highlighting is shown in \autoref{fig:pascal:standard:mod3:congruence:row:26}.
On the other hand, we could have choosed a column, compute the value 
for $a$ and then state a congruence with $b$ as free variable.

% the following chunk of statements is not clearly written and
% I believe it is not so important, so for now skip it.
\iffalse
\\\\
A question is still open: why do we choose row $3^4$ as reference
row?

It is useful to recall a theorem due to Fine:
\begin{theorem}
  A necessary and sufficient condition for a binomial coefficient
  ${{n} \choose {m}}$ to be divisible by a prime $p$ is that $n$
  be a power of $p$.
\end{theorem}
Consider the colouring for triangle $\mathcal{P}$, we can use the
given theorem to point out ``interesting'' rows, namely those rows
affected by the theorem, they correspond to powers
$3^1, 3^2, 3^3, 3^4, \ldots$, each one of them can be easily
recognized since dots lying on it have all the same colour. In the
triangle $127$ former rows are drawn and in order to have ``more
space'' to find a modular relationship between $d_{nk}$ and
$\hat{d}_{nk}$ we choose as \emph{reference} row the one with
index $3^4$.  From here we start moving backwards by rows toward
the root: observe that the entire row $3^4 -1$, containing
$3^4 -1$ remainders, of triangle $\mathcal{P}$ is the first
segment of the first column of $\mathcal{P}^{-1}$, in other words
$d_{3^4 -1,a} \equiv_{3} \hat{d}_{3^4 -1 -a, 0}$ for
$a \in \lbrace 0, \ldots, 3^4 -1\rbrace$.

\fi

% again the following paragraph is a technical detail that can 
% be understood only by talking.
\iffalse
It seems that coefficient $d_{3^4-1,0}$ acts as a pivot on which
the triangle ``flips'': the root moves toward the reader while the
bottom edge moves toward opposite the reader. This rigid motion is
captured by the following modular relationships among three
important points:
\begin{displaymath}
    \begin{split}
        d_{3^4 -1,0} &\equiv_{3} \hat{d}_{3^4 -1,0} \\
        d_{3^4 -1,3^4 -1} &\equiv_{3} \hat{d}_{0,0} \\
        d_{3^4 -3^3,3^3-1} &\equiv_{3} \hat{d}_{3^4 -3^3,3^3-1} \\
    \end{split}
\end{displaymath}
\fi

\subsection{$\mathcal{P}_{\equiv_{p}}$, where $p$ is a prime greater than $3$}

It is natural to ask if \autoref{eq:pascal:arrays:congruence:rows:cols}
holds for an arbitrary prime $p$.
\begin{conjecture}
    Let $p$ be a prime and let $\alpha\in\mathbb{N}$. 
    If $d_{nk}\in\mathcal{P}^{(\alpha)}$ and
    $\hat{d}_{nk}\in\left(\mathcal{P}^{-1}\right)^{(\alpha)}$, then:
    \marginpar{a general congruence over rows of $\mathcal{P}$
        and columns of $\mathcal{P}^{-1}$, for any prime $p$?}
    \begin{equation}
        d_{p^\alpha -b,a} \equiv_{p} \hat{d}_{p^\alpha -1-a,b-1} 
    \end{equation}
    where $b\in\lbrace1,\ldots,p^{\alpha}\rbrace$ and 
    $a\in\lbrace 0,\ldots,p^{\alpha}-b\rbrace$.
\end{conjecture}
We provide a proof sketch:
\begin{proof}
    Using closed formula for coefficients $d_{p^\alpha -b,a}$ and $\hat{d}_{p^\alpha -1-a,b-1}$
    we can rewrite:
    \begin{displaymath}
        {{p^\alpha -b} \choose {a}} \equiv_{p} {{p^\alpha -1-a}\choose{b-1} }\left(-1\right)^{p^{\alpha}-a-b}
    \end{displaymath}
    and simple manipulation of binomial coefficients yield:
    \begin{displaymath}
        {{p^\alpha -b} \choose {p^\alpha -a-b}} \equiv_{p} 
            {{p^\alpha -1-a}\choose{p^\alpha -a-b} }\left(-1\right)^{p^{\alpha}-a-b}
    \end{displaymath}
    rewrite the right hand side using the identity ${{-n}\choose{k}}={{n+k-1}\choose{k}}(-1)^{k}$:
    \begin{displaymath}
        {{p^\alpha -b} \choose {p^\alpha -a-b}} \equiv_{p} 
            {{-b}\choose{p^\alpha -a-b} }
    \end{displaymath}
    to close the proof we could represent $-b$ in base $p$ and, 
    since $b\in\lbrace1,\ldots,p^{\alpha}\rbrace$, the application of
    Lucas theorem to both members produces the same product of binomial
    coefficients, as required.

\end{proof}

\subsection{A proof of \emph{Sierpinski}'s gasket}

In this section we show that in a Pascal array $\mathcal{P}$ it is possible to
recognize a structure similar to the one observed by Sierpinski during his
studies on fractals. More precisely, we show that $\mathcal{P}^{(\alpha)}$, a
principal cluster of order $\alpha$, repeats itself $3$ times within a
\emph{chunk} of the principal cluster of one order bigger: such repetitions
happens in the first $2\,p^{\alpha}$ rows of $\mathcal{P}^{(\alpha+1)}$.
Moreover, those copies of $\mathcal{P}^{(\alpha)}$ surround a zero-hole of
order $\alpha$. Note that for even prime $p$, $\mathcal{P}^{(\alpha)}$ repeats
itself $3$ times in $\mathcal{P}^{(\alpha+1)}$, exactly as in the
\emph{Sierpinski's gasket}, having a pure recursive structure.

\input{Chapters/mod-p-characterization/pascal/pascal-standard-handle-negatives-centered-colouring-127-rows-mod5-partitioning-include-figure.tex}
On the other hand, for $p$ odd prime, $\mathcal{P}^{(\alpha)}$ repeats itself
in $\mathcal{P}^{(\alpha+1)}$ somewhere, without a complete recursive
structure, due to the oddness of $p$, ie. other coloured subtriangles appears
in $\mathcal{P}^{(\alpha+1)}$, see the cluster in the \emph{top left} corner of
\autoref{fig:pascal:mod5:principal:cluster:for:sierpinski:proof}.

However if we study the repetition up to row
$2\,p^{\alpha}$, the proof still hold for arbitrary prime $p$.

% the following paragraph should be put in a dedicated section, after this one.
\iffalse
, while in general we can say that maximal
triangles of coefficients multiples of $p$, appear with regularity in
$\mathcal{P}_{n+1}$ a number of times equals to:
\begin{displaymath}
    \frac{(p-1)p}{2}
\end{displaymath}
in other words, considering triangles $\mathcal{P}_{n}$ and
$\mathcal{P}_{n+1}$, there are $\frac{(p-1)p}{2}$ upside-down
maximal triangles, with all coefficients multiple of $p$, from row $p^n$
to row $p^{n+1}-1$; this result will be prove at the end of this 
section.
\fi
% ----------------------------------------------------------------------

\begin{proof}

  Let $\mathcal{P}^{(\alpha)}$ be the principal cluster of order $\alpha$ of
  Pascal array $\mathcal{P}$ and let $r$ be a row index for
  $\mathcal{P}^{(\alpha)}$, so $r \in \lbrace 0, \ldots, p^{\alpha} -1
  \rbrace$.
    
  Let $\mathcal{P}_{k;\alpha}$ be a \emph{chunk} of $\mathcal{P}^{(\alpha +1)}$
  that starts at the root and extends downward $k\,p^{\alpha}$ rows, therefore
  including $\mathcal{P}^{(\alpha)}$ as its first rows. 
  
  It is requested to
  prove that coefficients at \emph{equivalent positions} in the bottom left and
  bottom right triangles of $\mathcal{P}_{2;\alpha}$ are congruent, modulo $p$,
  to coefficients at \emph{equivalent positions} in $\mathcal{P}^{\alpha}$. 
  
  In order to formalize \marginpar{proving congruences over coefficients at
  equivalent positions} the concept of \emph{equivalent positions} we
  introduce the following objects: 
  \begin{itemize}
    \item the pair $(r,c)$ of indices is an \emph{equivalent position} 
        for coefficient $d_{rc}\in\mathcal{P}^{(\alpha)}$ and coefficient 
            $d_{rc}^{\swarrow}$ in the \emph{bottom left} triangle of $\mathcal{P}_{2;\alpha}$ if and only if
                $d_{rc}^{\swarrow} = d_{p^{\alpha}+r,c}$
    \item the pair $(r,c)$ of indices is an \emph{equivalent position} 
        for coefficient $d_{rc}\in\mathcal{P}^{(\alpha)}$ and coefficient 
            $d_{rc}^{\searrow}$ in the \emph{bottom right} triangle of $\mathcal{P}_{2;\alpha}$ if and only if
                $d_{rc}^{\searrow} = d_{p^{\alpha}+r,p^{\alpha}+c}$
  \end{itemize}
  in the \emph{top right} corner of \autoref{fig:pascal:mod5:principal:cluster:for:sierpinski:proof},
  equivalent position $(2,1)$ for $\mathcal{P}_{\equiv_{5}}^{(2)}$ are highlighted 
  for the sake of clarity.  After these definitions, we've to prove:
  \begin{displaymath}
    d_{rc} \equiv_p d_{rc}^{\swarrow} \equiv_p d_{rc}^{\searrow} 
  \end{displaymath}
  or, in other words:
  \begin{displaymath}
    {{r} \choose {c}} \equiv_p {{p^{\alpha}+r} \choose {c}} \equiv_p {{p^{\alpha}+r} \choose {p^{\alpha}+c}} 
  \end{displaymath}

  In order to prove such congruences we'll use Lucas theorem:
  first of all, observe that $c \leq r$ because $\mathcal{P}^{(\alpha)}$ 
  is a triangle, therefore $c \in \lbrace 0, \ldots, p^{\alpha} -1 \rbrace$,
  as $r$ satisfies.  By basis representation theorem, there exists
  sequences $\lbrace r_i\rbrace$ and $\lbrace c_i\rbrace$, 
  with both $r_i< p$ and $c_i < p$, for $i \in \lbrace 0, \ldots, p^{\alpha} -1 \rbrace$,
  such that:
  \begin{displaymath}
    \begin{split}
      r &= r_0 + r_1 p + r_2 p^2 + \ldots + r_{{\alpha}-1}p^{{\alpha}-1} \\
      c &= c_0 + c_1 p + c_2 p^2 + \ldots + c_{{\alpha}-1}p^{{\alpha}-1} \\
    \end{split}
  \end{displaymath}
  Settings for Lucas theorem are ready, hence apply it:
  \begin{displaymath}
    \begin{split}
      {{p^{\alpha}+r} \choose {c}} &\equiv_{p} {{r_0} \choose {c_0}} {{r_1} \choose {c_1}}{{r_2} \choose {c_2}} \ldots 
      {{r_{{\alpha}-1}} \choose {c_{{\alpha}-1}}}{{1} \choose {0}} \equiv_{p} {{r} \choose {c}}\\
      {{p^{\alpha}+r} \choose {p^{\alpha}+c}} &\equiv_{p} {{r_0} \choose {c_0}} {{r_1} \choose {c_1}}{{r_2} \choose {c_2}} \ldots 
      {{r_{{\alpha}-1}} \choose {c_{{\alpha}-1}}}{{1} \choose {1}} \equiv_{p} {{r} \choose {c}}\\
    \end{split}
  \end{displaymath}
  therefore coefficients located at \emph{equivalent position} 
  $(r,c)$ belong to the same remainder class of congruence relation
  modulo $p$, as required.
  \\\\

  For the second part \marginpar{proving that a zero-hole of order $\alpha$ 
  is surrounded within $\mathcal{P}_{2;\alpha}$} of the statement, we've to show that in
  $\mathcal{P}_{2;\alpha}$ a zero-hole of order $\alpha$ is
  surrounded by the three ``congruent'' subtriangles composed of
  coefficients $d_{rc}, d_{rc}^{\swarrow}$ and $d_{rc}^{\searrow} $, respectively.
  In the \emph{bottom left} corner of \autoref{fig:pascal:mod5:principal:cluster:for:sierpinski:proof},
  a zero-hole of order $1$ in $\mathcal{P}_{2;1}$ is highlighted for the sake of clarity.

  Observe that the very first coefficient $d_{p^{\alpha}, 0}$ and very last $d_{p^{\alpha}, p^{\alpha}}$ of row
  with index $p^{\alpha}$ are congruent to the unit, modulo $p$:
  \begin{displaymath}
    {{p^{\alpha}} \choose {0}} \equiv_{p}{{p^{\alpha}} \choose {p^{\alpha}}} \equiv_{p} 1
  \end{displaymath}
  while $p$ divides every coefficient between them, let
  $c\in\lbrace1,\ldots, p^{\alpha}-1 \rbrace$:
  \begin{displaymath}
    {{p^{\alpha}} \choose {c}} \equiv_{p} {{0} \choose {c_0}} {{0} \choose {c_1}}{{0} \choose {c_2}} \ldots 
    {{0} \choose {c_{{\alpha}-1}}}{{1} \choose {0}} \equiv_{p} 0
  \end{displaymath}
  By the recurrence rule ${{n+1}\choose {k+1}} = {{n} \choose {k}} + {{n}\choose{ k+1}}$
  characterizing $\mathcal{P}$, observe that:
  \begin{displaymath}
    \begin{split}
      d_{p^{\alpha}+1, 1} &\equiv_{p} d_{p^{\alpha}, 0} + d_{p^{\alpha}, 1}\equiv_{p} 1 \\
      d_{p^{\alpha}+1, p^{\alpha}} &\equiv_{p} d_{p^{\alpha}, p^{\alpha}-1} + d_{p^{\alpha}, p^{\alpha}}\equiv_{p} 1 \\
      d_{p^{\alpha}+1, i} &\equiv_{p} d_{p^{\alpha}, i-1} + d_{p^{\alpha}, i}\equiv_{p} 0 \quad \forall i \in \lbrace 2, \ldots, p^{\alpha} -1\rbrace \\
    \end{split}
  \end{displaymath}
  therefore row $p^{\alpha} + 1$ has one less coefficient multiple of $p$ 
  than row $p^{\alpha}$: $\left|\lbrace2,\ldots, p^{\alpha}-1 \rbrace\right|=
    \left|\lbrace1,\ldots, p^{\alpha}-1 \rbrace\right|-1$. 
    Since in row $p^{\alpha}$ there are $p^{\alpha}+1$ coefficients, where
  $p^{\alpha}-1$ of them are multiples of $p$, it follows that after $p^{\alpha}-1$ 
  rows there are no such coefficients at all, that happens at row $2\,p^{\alpha} -1$. 
  Formally, for any column index $c$:
  \begin{displaymath}
    \begin{split}
      {{2p^{\alpha} - 1} \choose {c}} &\equiv_{p} {{p^{\alpha} +(p^{\alpha}- 1)} \choose {c}} \\
      &\equiv_{p} {{p-1} \choose {c_0}} {{p-1} \choose {c_1}}{{p-1} \choose {c_2}} \ldots 
      {{p-1} \choose {c_{{\alpha}-1}}}{{1} \choose {0}} \\
      &\not\equiv_{p} 0
    \end{split}
  \end{displaymath}
  by representing $c=(c_{0}, \ldots,c_{\alpha-1})_{p}$ in base $p$, where
  $c_i \in \lbrace 0, \ldots, p-1 \rbrace$, for any $i\in\lbrace0,\ldots,\alpha-1\rbrace$.

  % the following derivation is simply a proof of coefficient extraction
  % using the definition of Riordan array for Pascal triangle, redundant.
  % Recall $\mathcal{P}$ is defined as the Riordan array :
  % \begin{displaymath}
  %   \mathcal{P} = \left(\frac{1}{1-t}, \frac{t}{1-t}  \right)
  % \end{displaymath}
  % hence the following derivation holds:
  % \begin{displaymath}
  %   \begin{split}
  %     {{p^n+r} \choose {c}} &\equiv_p [t^{p^n +r}]\frac{1}{1-t} \left(\frac{t}{1-t}\right)^c \\
  %     &\equiv_p [t^{p^n +r-c}](1-t)^{-(c+1)} \\
  %     &\equiv_p [t^{p^n +r-c}]\mathcal{G}\left\lbrace {{-(c+1)} \choose {k}}(-1)^k \right\rbrace_{k\in\mathbb{N}} \\
  %     &\equiv_p  {{-(c+1)} \choose {p^n +r-c}}(-1)^{p^n +r-c}  \\
  %     &\equiv_p  {{ p^n +r} \choose {p^n +r-c}} \left((-1)^{p^n +r-c}\right)^2  \\
  %     &\equiv_p  {{ p^n +r} \choose {c}}  \\
  %   \end{split}
  % \end{displaymath}

\end{proof}


The \marginpar{for every positive $k\in\mathbb{N}$, no coefficient multiple of $p$ lies on row $k\,p^{\alpha}-1$}
last argument can be generalized: consider $\mathcal{P}^{(\alpha)}$, then every row denoted by index 
$k\,p^{\alpha} -1$, for each $k\in\mathbb{N}\setminus\lbrace0\rbrace$, doesn't contain any 
coefficient multiple of $p$. Here's a short proof:
\begin{displaymath}
    \begin{split}
      {{kp^{\alpha}-1} \choose {c}} &\equiv_{p}{{(k-1)p^{\alpha}+ (p^{\alpha}-1)} \choose {c}}\\ 
        &\equiv_{p} {{p-1} \choose {c_0}} {{p-1} \choose {c_1}} \ldots 
      {{p-1} \choose {c_{{\alpha}-1}}}{{k-1} \choose {0}} \not\equiv_{p} 0
    \end{split}
\end{displaymath}
in the \emph{bottom right} corner of \autoref{fig:pascal:mod5:principal:cluster:for:sierpinski:proof}
such rows are highlighted, where $p=5$ and $k\in\lbrace1,\ldots,5\rbrace$.

% about the last proof it should be useful to build two images, where
% some coefficients at equivalent positions are highlighted and a picture
% that shows a triangle with a different colouring than the principal cluster
% of one order less.

\subsection{On the number of \emph{zero-holes} within 
    $\mathcal{P}^{(\alpha+1)}$}

Let us finish this section proving an observation about the number
of \emph{maximal} zero-holes of order $\alpha$ within a principal
cluster $\mathcal{P}^{(\alpha+1)}$ of one order greater. We start with
an important lemma that ``slices'' $\mathcal{P}^{(\alpha+1)}$ in strips,
each one of them composed of $p^{\alpha}$ rows.

\begin{lemma}
    Let $\mathcal{P}^{(\alpha+1)}$ be a principal cluster of order $\alpha+1$. 
    Denote with $\Omega_{j}$ the range that starts at row index $j\,p^{\alpha}$ and stops at
    row index $(j+1)p^{\alpha} -1$, and with $\mathcal{H}_{j}^{\bigtriangledown}$ the number
    of \emph{maximal} zero-holes of order $\alpha$ within $\Omega_{j}$. 
    Then: 
    \begin{displaymath}
        \mathcal{H}_{j}^{\bigtriangledown}=j \quad\text{where}\quad j\in \lbrace 1, \ldots, p-1 \rbrace
    \end{displaymath}
\end{lemma}

\begin{proof}
    By absurd, choose any $j\in \lbrace 1, \ldots, p-1 \rbrace$ and show
    that in range $\Omega_{j}$ cannot be one zero-hole more \emph{or} one zero-hole less,
    both of order $\alpha$: formally, $\mathcal{H}_{j}^{\bigtriangledown}=j\pm1$ yields a contraddiction, 
    for any choice of $j$.

    Proceed by cases:
    \begin{itemize}
        \item assume a zero-hole $h^{\bigtriangledown}$ is missing, so there exists a coefficient
                $\tilde{d}_{nk}\in h^{\bigtriangledown}$ such that $\tilde{d}_{nk}\not\equiv_{p}0$, while all 
                other coefficient $d_{nk}\in h^{\bigtriangledown}$ satisfies $d_{nk} \equiv_{p}0$.
                Proceed by cases on parity of $j$:
            \begin{description}
                \item[$j=2k+1$ for some $k$] Without loss of generality, suppose $h^{\bigtriangledown}$ is the one in the 
                very middle, due to symmetric shape of $\mathcal{P}$ (the cases where it is on the left or 
                on the right are less interesting) and
                suppose that $p$ does not divide the coefficient in the very bottom corner of $h^{\bigtriangledown}$, 
                formally:
                \begin{displaymath}
                    \tilde{d}_{(j+1) p^{\alpha} -2, (k+1)p^{\alpha} -1}\not\equiv_{p}0
                \end{displaymath}
                But this is impossible because if $d_{nk}\in \mathcal{P}$ 
                then $d_{nk} = d_{n-1,k-1} + d_{n-1, k}$, so:
                \begin{displaymath}
                    \begin{split}
                        0&\not\equiv_{p}\tilde{d}_{(j+1) p^{\alpha} -2, (k+1)p^{\alpha} -1} \\
                        &\equiv_{p} d_{(j+1) p^{\alpha} -3, (k+1)p^{\alpha} -1} + d_{(j+1) p^{\alpha} -3, (k+1)p^{\alpha}-2 }\\
                        &\equiv_{p}0
                    \end{split}
                \end{displaymath}
                In the \emph{top} of \autoref{fig:pascal-mod7-zero-holes} there's a highlighted strip of rows 
                within $\mathcal{P}_{\stackrel{\circ}{\equiv_{7}}}^{(2)}$,where $j=5=2\cdot2+1$ and $p=7$, so $k=2$
                and $\alpha=1$.
                The highlighted coefficient on the very bottom is the one handled in the proof, it is 
                $\tilde{d}_{6\cdot 7-2, 3\cdot 7 -1}=\tilde{d}_{40, 20}$: to finish the proof over 
                those highlighted coefficients it necessary to use recurrence rule for binomial coefficients,
                otherwise we cannot prove the argument using the symmetry property only. 

                \item[$j=2k$ for some $k$] Without loss of generality, 
                suppose  $ h^{\bigtriangledown}$ is the one on the very left. 
                Choose $r \in\lbrace 0,\ldots,p^n-2\rbrace$, so there exists $c\in\lbrace r+1,\ldots,p^n-1\rbrace$ such that:
                \begin{displaymath}
                    \tilde{d}_{j\,p^{\alpha} +r, c}\not\equiv_{p}0
                \end{displaymath}
                Since $ h^{\bigtriangledown}$ is the only one missing, by symmetry of $\mathcal{P}$ we get another contradiction: 
                \begin{displaymath}
                    0\not\equiv_{p}\tilde{d}_{j\, p^{\alpha} +r, c} 
                        \equiv_{p} d_{j\, p^{\alpha} +r, j\, p^{\alpha} +r-c}\equiv_{p}0
                \end{displaymath}
            \end{description}
        \item assume triangle $ h^{\bigtriangledown}$ is over, therefore the very first coefficient 
            $\tilde{d}$ in the \emph{top-left} corner of $ h^{\bigtriangledown}$ has to satisfy:
            \begin{displaymath}
                 \tilde{d} \equiv_{p} d_{j\,p^{n},j\,p^{n}+1}
            \end{displaymath}
            by structure of $\mathcal{P}$, coefficient $d_{j\,p^{n},j\,p^{n}+1}$ has no
            meaning so $\tilde{d}$ cannot satisfy the requested congruence.
    \end{itemize}
\end{proof}

\input{Chapters/mod-p-characterization/pascal/pascal-mod7-abstracting-zero-holes-include-figure}

\begin{theorem}
    Let $\mathcal{P}^{(\alpha+1)}$ be a principal cluster of order $\alpha+1$. 
    Then, within $\mathcal{P}^{(\alpha+1)}$ there are ${{p}\choose{2}}$ 
    \emph{maximal} zero-holes of order $\alpha$. 
\end{theorem}

\begin{proof}
    Let $j\in\lbrace 1, \ldots, p-1 \rbrace$, by previous lemma between row index $j\,p^n$ and
    row index $(j+1)p^n -1$, there are $j$ \emph{maximal} zero-holes of order $\alpha$, 
    therefore consider the sum:
    \begin{displaymath}
        \sum_{i=1}^{p-1}{i} = \frac{(p-1)p}{2}
    \end{displaymath}
    as required.

\end{proof}

In the \emph{bottom} of \autoref{fig:pascal-mod7-zero-holes} 
$\mathcal{P}_{\stackrel{\circ}{\equiv_{7}}}^{(2)}$ is reported: within it there are
${{7}\choose{2}}=21$ zero-holes of order $1$.


\subsection{Congruences over antidiagonals of $\mathcal{P}$ and $\mathcal{P}^{-1}$}

In this section we show two results: a first one about congruences over coefficients
lying on the same \emph{antidiagonal}, spaced by a fixed distance; a second one
about a colour mapping among coefficients, in $\mathcal{P}$ and in the inverse,
at the same location.


% PAY ATTENTION: the following corollary is not correct since congruences can be
% used only in the ring of polynomials.
\iffalse
\begin{corollary}
Let $\mathcal{P}$ be the Pascal array and let $p$ be a prime. Choose $k\in\mathbb{N}$, 
than $k$-th column is congruent to $k$-antidiagonal, modulo $p$.
\end{corollary}
\begin{proof}
    \begin{displaymath}
        \begin{split}
            { {n} \choose {k} } &\equiv_{p} { {n} \choose {n-k} } \\
            d_{nk} &\equiv_{p} d_{n,n-k}\\
            \sum_{n\geq 0}{d_{nk} t^n} &\equiv_{p}\sum_{n\geq 0}{d_{n,n-k} t^n} \\
            d(t)h(t)^k &\equiv_{p}\sum_{n\geq 0}{d_{n,n-k} t^n} \\
        \end{split}
    \end{displaymath}
no a standard form for antidiagonal exists, so on the right we leave the explicit
expression for the $k$-th antidiagonal.
\end{proof}
\fi

In order to state the following lemma we define a subset of $\mathcal{P}$
composed of coefficients lying on \emph{antidiagonals}. In the following, 
given $\mathcal{P}^{(\alpha)}$ a principal cluster of order $\alpha$, 
denote with $\Theta_{\diagdown}^{(\alpha)}$ a set of positions, encoding
each one of them as a pair of integers:
\begin{displaymath}
    \Theta_{\diagdown}^{(\alpha)}=\left\lbrace(n,k) : n\in\lbrace p^{\alpha},\ldots,p^{\alpha+1}-1\rbrace
        \,,k\in\lbrace0,\ldots,n-p^{\alpha}\rbrace    \right\rbrace
\end{displaymath}

\begin{lemma}
    Let $p$ be a prime and $\mathcal{P}^{(\alpha)}$ a principal cluster of order $\alpha$.
    Consider a position $(n,k)\in \Theta_{\diagdown}^{(\alpha)}$, then for any $\gamma\in\mathbb{N}$:
    \begin{displaymath}
        d_{n,k} \equiv_{p} d_{n+\gamma p^{\alpha+1}, k+\gamma p^{\alpha+1}}
    \end{displaymath}
\end{lemma}
\begin{proof} % $n+\gamma p^{m+1}$
    By the basis representation theorem, write $n$ in base $p$ as:
    \begin{displaymath}
        n = n_{0} + n_{1}p + n_{2}p^2 + \ldots + n_{\alpha}p^\alpha %+ 0p^{\alpha+1} + \ldots + 0p^k
    \end{displaymath}
    since $n<p^{\alpha+1}$. For $k$, on the other hand, consider extrema cases:
    \begin{itemize}
        \item $n=p^{\alpha}\rightarrow k\in\lbrace0\rbrace$
        \item $n=p^{\alpha+1}-1 \rightarrow k\in\lbrace 0,\ldots,p^{\alpha}(p-1)-1\rbrace$
    \end{itemize}
    so, for any choice of $n$, we can write $k$ in base $p$ as:
    \begin{displaymath}
        k = k_{0} + k_{1}p + k_{2}p^2 + \ldots + k_{\alpha}p^\alpha %+ 0p^{\alpha+1} + \ldots + 0p^k
    \end{displaymath}
    an application of Lucas theorem finishes the proof:
    \begin{displaymath}
        {{n+\gamma p^{\alpha+1}} \choose { k+\gamma p^{\alpha+1}}} \equiv_{p} 
            {{n_{0}} \choose {k_{0}}}  
            {{n_{1}} \choose {k_{1}}} 
            {{n_{2}} \choose {k_{2}}}
            \ldots
            {{n_{\alpha-1}} \choose {k_{\alpha-1}} }
            {{n_{\alpha}} \choose {k_{\alpha}} }
            {{\gamma} \choose {\gamma}} 
            \equiv_{p}{{n} \choose {k}}  
    \end{displaymath}
    which is the requested relation.
\end{proof}


Previous lemma is important because it does hold for the inverse array $\mathcal{P}^{-1}$ too:
\begin{displaymath}
    \begin{split}
        \hat{d}_{n,k} &\equiv_{p} \hat{d}_{n+\gamma p^{\alpha+1}, k+\gamma p^{\alpha+1}} \\
        (-1)^{n-k}d_{n,k} &\equiv_{p} (-1)^{n+\gamma p^{\alpha+1}-(k+\gamma p^{\alpha+1})}d_{n+\gamma p^{\alpha+1}, k+\gamma p^{\alpha+1}} \\
        (-1)^{n-k}d_{n,k} &\equiv_{p} (-1)^{n-k}d_{n+\gamma p^{\alpha+1}, k+\gamma p^{\alpha+1}} \\
    \end{split}
\end{displaymath}
Since there exists $(-1)^{-1}\mod p$ we can multiply by it both member $n-k$ times,
obtaining the congruence proved in the previous lemma.
In \autoref{fig:pascal-multiples-over-antidiagonal} are shown both the set
$\Theta_{\diagdown}^{(1)}$ and the highlighting of congruent coefficients
according to previous result, within $\mathcal{P}$ and in its inverse.

Pay attention: this doesn't relate coefficients
of $\mathcal{P}$ and $\mathcal{P}^{-1}$ (from the colouring point of view 
doesn't imply any relation about colours assignment: generally it is not the case,
except for even $p$), it merely says that 
congruent coefficients on the chosen antidiagonal, \emph{in the same triangle
either $\mathcal{P}$ or $\mathcal{P}^{-1}$}, repeat with structure.
\\\\
The following theorem tackle what the above argument leaves out: it 
shows how to colour an antidiagonal $p^{\alpha}$ of $\mathcal{P}$
having coloured the same antidiagonal of $\mathcal{P}^{-1}$, and viceversa.

\input{Chapters/mod-p-characterization/pascal/multiples-over-antidiagonal-include-figure}

\begin{theorem}
    Let $\mathcal{P}^{(\alpha)}$ a principal cluster of order $\alpha$ and denote with 
    $d_{nk}, \hat{d}_{nk}$ the generic elements in arrays $\mathcal{P}$ and $\mathcal{P}^{-1}$,
    respectively. 
    Choose an odd prime $p$ and let $c\in \lbrace 0, \ldots, p-1 \rbrace$ be a remainder class
    witness, then:
    \begin{displaymath}
        \begin{split}
            d_{n,n-p^{\alpha}} \equiv_{p} c &\leftrightarrow \hat{d}_{n,n-p^{\alpha}} \equiv_{p} p-c
        \end{split}
    \end{displaymath}
    for any $n\geq p^{\alpha}$.
\end{theorem}
\begin{proof}
We show both directions using a set of congruences: reading them from top to bottom provides a 
proof for $\rightarrow$ direction, while reading them from bottom to top provides a proof for 
$\leftarrow$ direction. Recall that $p^\alpha$ is odd because $p$ is odd by hp, therefore $(-1)^{p^\alpha} = -1$:
\begin{displaymath}
    \begin{split}
        d_{n,n-p^{\alpha}} &\equiv_{p} c \\
        (-1)^{p^\alpha}\hat{d}_{n,n-p^{\alpha}} &\equiv_{p} c \\
        (-1)^{p^\alpha }(-1)\hat{d}_{n,n-p^{\alpha}} &\equiv_{p} -c \\
        (-1)^{p^\alpha }(-1)\hat{d}_{n,n-p^{\alpha}} &\equiv_{p} p -c \\
        \hat{d}_{n,n-p^{\alpha}} &\equiv_{p} p -c \\
    \end{split}
\end{displaymath}
\end{proof}

\subsection{$\equiv_{p}$ over $\mathcal{P}$ and $\mathcal{P}^{-1}$,
    where $p$ \emph{is not} a prime}

\label{subsection:pascal:congruence:characterization:p:not:prime}

\input{Chapters/mod-p-characterization/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-4-partitioning-include-figure.tex}

The case when $p$ is not a prime yield coloured triangles that, nonetheless some 
repetitive patterns appears, their shape isn't so sharp as the case when $p$ is prime.
In particular, $p$ can take the following forms: 
\begin{itemize}
    \item $p=k^{\alpha}$, where $k$ is a prime and $\alpha\in\mathbb{N}$. This case
        is the first step in the generalization toward congruences where the modulo 
        isn't a prime, and it is explored by \emph{McLean}\footnote{put here the reference to McLean's work}.
        In \autoref{fig:pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-4-partitioning-triangle} 
        $\mathcal{P}_{\stackrel{\circ}{\equiv_{4}}}$ is shown;
    \item $p=p_{1}^{\alpha_{1}}p_{2}^{\alpha_{2}}\ldots p_{n}^{\alpha_{n}}$, where $p_{1},p_{2},\ldots,p_{n}$ 
        are primes and $\alpha_{1},\alpha_{2},\ldots,\alpha_{n}\in\mathbb{N}$. This is the most general case
        which yield colourings that seems quite random.
\end{itemize}

