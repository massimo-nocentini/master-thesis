% article example for classicthesis.sty
\documentclass[11pt,a4paper]{article} % KOMA-Script article scrartcl
\usepackage{lipsum}
\usepackage{url}
\usepackage[nochapters,eulermath,beramono]{classicthesis} % nochapters
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{caption}

% add 'final' option to make a clear version without any markup or colouring
\usepackage[authormarkup=none]{changes}

\usepackage{marginnote}

\usepackage[T1]{fontenc}
%\usepackage{concrete}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
%\newtheorem{proof}[theorem]{Proof}

\newcommand{\vect}[1]{\boldsymbol{#1}}

% for tracking changes
\definechangesauthor[name={under review}, color=blue]{testing}
\definechangesauthor[name={blending edge}, color=orange]{sid}

% an environment for lenghty equations breaking right margin
% taken from here:
% http://tex.stackexchange.com/questions/156877/center-over-long-equations-between-both-margins
\newsavebox{\overlongequation}
\newenvironment{lenghtydisplaymath}
 {\begin{displaymath}\begin{lrbox}{\overlongequation}$\displaystyle}
  {$\end{lrbox}\makebox[0pt]{\usebox{\overlongequation}}\end{displaymath}}

\begin{document}
    \title{\rmfamily\normalfont\spacedallcaps{Colouring Riordan arrays}}
    \author{\spacedlowsmallcaps{Donatella Merlini} \\ \spacedlowsmallcaps{Massimo Nocentini}}
    \date{\today} 
    
    \maketitle
    
    \begin{abstract}
        This short document is a collection of some \emph{Riordan arrays}, coloured 
        according different partition schemes.
    \end{abstract}
       
    \tableofcontents

    \newpage


    \section{Another characterization}

    \subsection{A theorem when $\mathcal{R}(d(t), td(t))$}

    By observing previous results, it seems there's a relation
    about the shape of a Riordan array $\mathcal{R}(d(t), td(t))$ 
    and the shape of column $k$ generating function. 
    
    The question is: does exist a sequence $\lbrace s_i \rbrace_{i \in \mathbb{N}}$ 
    of coefficients such that column $k$ generating function is $S(h(t)^{j_k})$, where $S$
    is a formal power series over the sequence? In expanded form: 
    \begin{displaymath}
        \added{d(t)h(t)^k = }s_0h(t)^{j_k} + s_1 h(t)^{j_k+1} + s_2 h(t)^{j_k+2} + 
            \ldots + s_i h(t)^{j_k+i} + \ldots
    \end{displaymath}
    for some $j_k \in \mathbb{Z}$, where $j_k$ is a notation to denote an index $j$ 
    which depends on $k$.

    \begin{proof}

    Since $h(t)=td(t)$, let $\hat{h}(y)$ be its compositional inverse, therefore:
    \begin{displaymath}
        y = h(\hat{h}(y)) = \hat{h}(y)d(\hat{h}(y)) 
    \end{displaymath}
    so:
    \begin{displaymath}
        \hat{h}(y) = \frac{y}{d(\hat{h}(y)) }
    \end{displaymath}
    and evaluating at $1+y$:
    \begin{displaymath}
        d(\hat{h}(1+y)) = \frac{1+y}{ \hat{h}(1+y)}
    \end{displaymath}
    Recall the definition of the characterization $\mathcal{R}_{y=h(t)-1}\left( f(y), 1+y \right)$,
    where $f(y)=d(\hat{h}(1+y))$, so the column $k$ generating function can be rewritten as:
    \begin{displaymath}
        \frac{(1+y)^{k+1}}{ \hat{h}(1+y)}
    \end{displaymath}
    Let $k(y)$ be the formal power series with coefficients in 
    $\lbrace k_i \rbrace_{i\in\mathbb{N}}$ such that :
    \begin{displaymath}
        k(y) = \frac{1}{ \hat{h}(1+y)} = \sum_{i\geq 0}{k_i}y^{i}
    \end{displaymath}
    Since $(1+y)^{k+1}$ has a binomial shape:
    \begin{displaymath}
        (1+y)^{k+1} = \sum_{s= 0}^{k+1}{{k+1}\choose{s}}y^{s}= \sum_{s\geq 0}{{k+1}\choose{s}}y^{s}
    \end{displaymath}
    because ${{n}\choose{m}}$ vanishes if $n<m$. Therefore $k(y)(1+y)^{k+1}$ is a convolution:
    \begin{displaymath}
        k(y)(1+y)^{k+1} = \sum_{s\geq 0}{\sum_{j=0}^{s}{k_j {{k+1}\choose{s-j}}} y^{s}} = 
            \sum_{s\geq 0}{\alpha_{s}^{(k+1)} y^{s}}
    \end{displaymath}
    where $\alpha_{s}^{(k+1)} \in \mathbb{Z}$ such that $\alpha_{s}^{(k+1)}=\sum_{j=0}^{s}{k_j {{k+1}\choose{s-j}}}$.
    By variable substitution $y = h(t)-1$ rewrite as:
    \begin{displaymath}
        \sum_{s\geq 0}{\alpha_{s}^{(k+1)} y^{s}}
            = \sum_{s\geq 0}{\alpha_{s}^{(k+1)} (h(t)-1)^{s}}
            = \sum_{s\geq 0}{(-1)^{s}\alpha_{s}^{(k+1)} (1-h(t))^{s}}
    \end{displaymath}
    calling $\beta_{s}^{(k+1)}=(-1)^{s}\alpha_{s}^{(k+1)}$ and expanding $(1-h(t))^{s}$
    as a binomial in $h(t)$ yield:
    \begin{displaymath}
        \sum_{s\geq 0}{\beta_{s}^{(k+1)} {\sum_{r=0}^{s}{(-1)^{r}{{s}\choose{r}} h(t)^{r}}}} =
        \sum_{s\geq 0}{ \sum_{r=0}^{s}{\beta_{s}^{(k+1)}(-1)^{r}{{s}\choose{r}} h(t)^{r}}} =
    \end{displaymath}
    calling $\gamma_{s,r}^{(k+1)}=\beta_{s}^{(k+1)}(-1)^{r}{{s}\choose{r}}$ and making 
    unbounded the inner sum yield: 
    \begin{displaymath}
        \sum_{s\geq 0}{ \sum_{r=0}^{s}{\beta_{s}^{(k+1)}(-1)^{r}{{s}\choose{r}} h(t)^{r}}} =
        \sum_{s\geq 0}{ \sum_{r\geq 0}{\gamma_{s,r}^{(k+1)} h(t)^{r}}} =
        \sum_{r\geq 0}{ \left(\sum_{s\geq 0}{\gamma_{s,r}^{(k+1)} }\right) h(t)^{r}}
    \end{displaymath}
    calling $\nu_{r}^{(k+1)}=\sum_{s\geq 0}{\gamma_{s,r}^{(k+1)} }$, the following equation
    joins our starting point with the requested argument:
    \begin{displaymath}
        \frac{(1+y)^{k+1}}{ \hat{h}(1+y)} = 
        \frac{(1+y)(1+y)^{k}}{ \hat{h}(1+y)} = 
        \frac{h(t)h(t)^{k}}{ \hat{h}(h(t))} = 
        d(t)h(t)^{k} = \sum_{r\geq 0}{ \nu_{r}^{(k+1)} h(t)^{r}}
    \end{displaymath}

    \end{proof}



    \section{Pascal}


    % the following derivation isn't included in the main thesis document 
    % since contains a subtle mistake in my opinion, where in the congruence both
    % members are multiplied by the indeterminate variable `t', it is not fair that step...
    We present a modular characterization under the theory of Riordan arrays, using the
    congruence modulo a prime $p$. Choose $n\in\mathbb{N}$ and let $\mathcal{P}_n$ denote the
    same portion of $\mathcal{P}$ as in the preceding proof:
      \begin{displaymath}
          \begin{split}
                {{r} \choose {c}} &\equiv_p {{p^n+r} \choose {c}} \\
                {{r} \choose {c}}t^r &\equiv_p {{p^n+r} \choose {c}}t^r \\
                \sum_{r\geq 0}{{{r} \choose {c}}t^r} &\equiv_p \sum_{r\geq 0}{{{p^n+r} \choose {c}}t^r} \\
                d(t)h(t)^{c} &\equiv_p \sum_{k\geq p^n}{{{k} \choose {c}}t^{k-p^n}} \\
                d(t)h(t)^{c} &\equiv_p t^{-p^n}\sum_{k\geq p^n}{{{k} \choose {c}}t^{k}} \\
                d(t)h(t)^{c} &\equiv_p t^{-p^n}\left(
                    \sum_{k\geq c}{{{k} \choose {c}}t^{k}}-\sum_{k=c}^{p^n -1}{{{k} \choose {c}}t^{k}}\right) \\
                d(t)h(t)^{c} &\equiv_p t^{-p^n}\left(
                    \sum_{k\geq 0}{{{k} \choose {c}}t^{k}}-\sum_{k=c}^{p^n -1}{{{k} \choose {c}}t^{k}}\right) \\
                d(t)h(t)^{c} &\equiv_p t^{-p^n}\left(d(t)h(t)^{c} -\sum_{k=c}^{p^n -1}{{{k} \choose {c}}t^{k}}\right) \\
          \end{split}
      \end{displaymath}
    Now assume $c \geq p^n$ in order to make the sum vanish:
      \begin{displaymath}
          \begin{split}
                d(t)h(t)^{c} &\equiv_p t^{-p^n} d(t)h(t)^{c} \\
                d(t)h(t)^{c} &\equiv_p d(t)h(t)^{c-p^n} (1-t)^{-p^n} \\
          \end{split}
      \end{displaymath}
    Since in general the inverse $\left((1-t)^{-p^n}\right)^{-1}\mod p$ is not $(1-t)^{p^n}$
    (we should prove it), let us proceed with algebraic manipulation:
      \begin{displaymath}
          \begin{split}
                d(t)h(t)^{c} &\equiv_p d(t)h(t)^{c-p^n}\left( (1-t)^{p^n}\right)^{-1} \\
                d(t)h(t)^{c} &\equiv_p d(t)h(t)^{c-p^n}\left(\sum_{k=0}^{p^n}{{{p^n} \choose {k}}(-t)^k } \right)^{-1}\\
                d(t)h(t)^{c} &\equiv_p d(t)h(t)^{c-p^n}\left(
                    1 + \sum_{k=1}^{p^n -1}{{{p^n} \choose {k}}(-t)^k +(-t)^{p^n} }\right)^{-1} \\
          \end{split}
      \end{displaymath}
    By Lucas theorem the inner sum vanish, since $k\in\lbrace 1, \ldots, p^n -1 \rbrace$:
      \begin{displaymath}
        \begin{split}
          {{p^n} \choose {k}} &\equiv_{p} {{0} \choose {k_0}} {{0} \choose {k_1}} \ldots 
          {{0} \choose {k_{n-1}}}{{1} \choose {0}}\equiv_{p} 0 
        \end{split}
      \end{displaymath}
    Therefore:
      \begin{displaymath}
          \begin{split}
                d(t)h(t)^{c} &\equiv_p d(t)h(t)^{c-p^n}\left(1 + (-t)^{p^n}\right)^{-1} \\
          \end{split}
      \end{displaymath}
    And assuming $p$ odd:
      \begin{displaymath}
          \begin{split}
                d(t)h(t)^{c} &\equiv_p \frac{d(t)h(t)^{c-p^n}}{1 - t^{p^n}} \\
          \end{split}
      \end{displaymath}



    \subsection{Expanded arrays and coloured triangles}

    % mod 2
    Expansion of Riordan array $\mathcal{P}$:
    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
    Expansion of Riordan array $\mathcal{P}^{-1}$:
    \input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}

    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}

    % mod 3
    % the following matrices are identical to the previous ones
    %\input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-matrix.tex}
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-matrix.tex}

    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-figure.tex}
    \input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-figure.tex}

    % mod 5
    % the following matrices are identical to the previous ones
    %\input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod5-partitioning-include-matrix.tex}
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod5-partitioning-include-matrix.tex}

    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-mod5-partitioning-include-figure.tex}
    \input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-mod5-partitioning-include-figure.tex}

    % the following two rows refer to old triangles, pay attention on the filename schema.
    \input{../sympy/pascal/Pascal-standard-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/pascal/Pascal-inverse-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \subsection{Coloured triangles: multiples of primes, abstracting over remainder classes}

    In this section we report some coloured triangles that use a partitioning similar to the modular one, 
    with the difference that, if $p$ is a module, than remainder classes $[1]_p, \ldots, [p-1]_p$
    are collected and abstracted as one big class, getting a single colour.

    Up to now, we ignore signs for inverse triangles, hence they are the same as the corresponding standard triangles.

    An observation: it is interesting to point out the colouring when a \emph{non prime} module $p$ is used, in
    our case $p=4$. The structure ``has noise'' respect structures relative to a prime $p$, where patterns
    show sharply.


    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-3-partitioning-include-figure}
    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-4-partitioning-include-figure}
    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-5-partitioning-include-figure}
    \input{../sympy/pascal/pascal-standard-ignore-negatives-centered-colouring-127-rows-multiples-of-7-partitioning-include-figure}

    % since we ignore signs, the inverses are the same of the standard ones.
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-multiples-of-3-partitioning-include-figure}
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-multiples-of-4-partitioning-include-figure}
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-multiples-of-5-partitioning-include-figure}
    %\input{../sympy/pascal/pascal-inverse-ignore-negatives-centered-colouring-127-rows-multiples-of-7-partitioning-include-figure}

    \section{Fibonacci}

    Expansion of Riordan array $\mathcal{F}$:
    \input{../sympy/fibonacci/Fibonacci-standard-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
    Expansion of Riordan array $\mathcal{F}^{-1}$:
    \input{../sympy/fibonacci/Fibonacci-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}

    \input{../sympy/fibonacci/Fibonacci-standard-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/fibonacci/Fibonacci-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \input{../sympy/fibonacci/Fibonacci-standard-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/fibonacci/Fibonacci-inverse-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \section{Catalan}

    \subsection{Traditional version}

    \added[id=sid]{Let $\mathcal{C}_{h}$ a principal $h$-cluster of
    the Catalan array, in its traditional definition: We attempt to point out
    some properties about $\mathcal{C}_{h+1}$: }
    \begin{itemize}
        \item a more general pattern, for any $h\in\mathcal{N}$, 
            a coefficient $d_{p^{h}-1,k}$, for $k\in\lbrace0,\ldots,p^{h}-1 \rbrace$, 
            satisfies:
            \begin{displaymath}
                d_{p^{h}-1,k} \equiv_{p} 0
            \end{displaymath}
        \item consider the subcluster $\mathcal{C}_{h}^{(0,p^{h}-1)}$ of 
            $\mathcal{C}_{h}$ obtained by removing antidiagonal $0$ (namely,
            the boundary one, composed by $1$s only) and by removing row $p^{h}-1$.
            By construction, $\mathcal{C}_{h}^{(0,p^{h}-1)}$ is a triangle too, 
            with $p^{h}-2$ coefficients per side. Therefore, $\mathcal{C}_{h+1}$
            is composed on the very top, starting at the root, by a copy of $\mathcal{C}_{h}$,
            while on the bottom there are three triangles:
            \begin{itemize}                
                \item an equilateral triangle $T_{\equiv_{p} 0}^{(h)}$, 
                    with $p^{h}-1$ coefficients on each side, such that:
                    \begin{displaymath}
                        d_{nk} \in T_{\equiv_{p} 0}^{(h)} \rightarrow d_{nk} \equiv_{p} 0
                    \end{displaymath}
                    where $n\in\lbrace p^{h},\ldots,p^{h+1}-2\rbrace$ and 
                    $k\in\lbrace 0,\ldots, n-p^{h}\rbrace$, in other words
                    $k\in\lbrace 0,\ldots, p^{h}(p-1)-2\rbrace$;
                \item a mirror copy of $\mathcal{C}_{h}^{(0,p^{h}-1)}$ respect column orientation,
                    defining coefficients $d_{nk}$  
                    where $n\in\lbrace p^{h},\ldots,p^{h+1}-2\rbrace$ and 
                    $k\in\lbrace 1,\ldots, p^{h}-2\rbrace$;
                \item a segment of coefficients $d_{n, p^{h}-1} \equiv_{p} 0$ 
                    where $n\in\lbrace p^{h},\ldots,p^{h+1}-2\rbrace$;
                \item a copy of $\mathcal{C}_{h}^{(0,p^{h}-1)}$,
                    defining coefficients $d_{nk}$  
                    where $n\in\lbrace p^{h}+1,\ldots,p^{h+1}-2\rbrace$ and 
                    $k\in\lbrace p^{h},\ldots, n-1\rbrace$;
            \end{itemize}                
    \end{itemize}
    In order to formally proof the above characterization for principal 
    $(h+1)$-cluster, we tackle the problem more generally, toward
    an application of \emph{Lagrange Inversion Formula} \footnote{
        which should be presented and proved in a dedicated 
        introductory section}:
    \begin{displaymath}
        d_{nk} = [t^n] \frac{1-\sqrt{1-4\,t}}{2\,t}\,
            \left(\frac{1-\sqrt{1-4\,t}}{2}\right)^{k}
               = [t^{n+1}] \left(\frac{1-\sqrt{1-4\,t}}{2}\right)^{k+1} 
    \end{displaymath}
    The version of the \emph{LIF} we'll apply is the following one:
    \begin{displaymath}
        \alpha\,\left[z^\alpha\right] A(z)^{\beta} = 
            \beta\,\left[w^{\alpha-\beta}\right]\Phi(w)^{\alpha}
    \end{displaymath}
    where $\alpha,\beta\in\mathbb{Z}$ and function $A$ relates to function
    $\Phi$ according to: 
    \begin{displaymath} A(z)=z\,\Phi(A(z)) \end{displaymath}
    under the constraint $\Phi(0)\not=0$, otherwise a contraddiction arises
    (critical relation is emphasized with $\circeq$ symbol):
    \begin{displaymath} A(z)=z\,\Phi(0) \circeq 0 \rightarrow z\circeq\frac{0}{\Phi(0)} \end{displaymath}
    
    An attempt to use theorem's ``from right to left'' direction, makes 
    the following definitions:
    \begin{displaymath}
        \begin{split}
            \Phi(t)&=\frac{1-\sqrt{1-4\,t}}{2}\\
            \alpha&=k+1\\
        \end{split}
    \end{displaymath}
    Since $\Phi(0)=0$ we cannot apply the theorem directly, so try
    a combinatorial interpretation. Observe that:
    \begin{displaymath}
        [t^{n+1}] \left(\frac{1-\sqrt{1-4\,t}}{2}\right)^{k+1} 
    \end{displaymath}
    requires to extract coefficient $n+1$ from the $(k+1)$-fold
    convolution of Catalan numbers' generating function, \emph{shifted
    by one place}, with itself. Before going on, be careful
    to understand what coefficients are introduced; the
    following expansion defines a sequence $\lbrace \hat{c}_{i}\rbrace_{i\in\mathbb{N}}$:
    \begin{displaymath}
        \frac{1-\sqrt{1-4\,t}}{2} = t + t^{2} + 2 t^{3} + 5 t^{4} 
            + 14 t^{5} + 42 t^{6} + 132 t^{7} + 429 t^{8} + 1430 t^{9} 
            + \mathcal{O}\left(t^{10}\right)
    \end{displaymath}
    where $\hat{c}_{0}=0$. On the other hand the following one, defines a sequence 
    $\lbrace c_{i}\rbrace_{i\in\mathbb{N}}$, the traditional Catalan numbers:
    \begin{displaymath}
        \frac{1-\sqrt{1-4\,t}}{2\,t} = 1 + t + 2 t^{2} + 5 t^{3} + 14 t^{4} 
            + 42 t^{5} + 132 t^{6} + 429 t^{7} + 1430 t^{8} + 4862 t^{9} 
            + \mathcal{O}\left(t^{10}\right)
    \end{displaymath}
    so the relationship $\hat{c}_{j} = c_{j-1}$ holds, for any $j\in\mathbb{N}$, 
    with boundary condition $c_{-1}=0$. 

    After this subtle point, there exists indices $i_{1}, i_{2}, \ldots, i_{k+1}$,
    where $i_{j}\in\lbrace0,\ldots,n+1\rbrace$ for each $j\in\lbrace1,\ldots,k+1\rbrace$, 
    such that:
    \begin{displaymath}
        [t^{n+1}] \left(\frac{1-\sqrt{1-4\,t}}{2}\right)^{k+1} 
            = \sum_{i_{1}+ i_{2}+ \ldots+ i_{k+1}=n+1}{
                \hat{c}_{i_{1}}\,\hat{c}_{i_{2}}\,\ldots\,\hat{c}_{i_{k+1}} }
    \end{displaymath}
    which is the same as:
    \begin{displaymath}
        [t^{n+1}] \left(\frac{1-\sqrt{1-4\,t}}{2}\right)^{k+1} 
            = \sum_{i_{1}+ i_{2}+ \ldots+ i_{k+1}=n+1}{
                c_{i_{1}-1}\,c_{i_{2}-1}\,\ldots\,c_{i_{k+1}-1} }
    \end{displaymath}

    Since $c_{j}$ is a Catalan coefficient, 
    by definition of array $\mathcal{C}$, we observe that:
    \begin{displaymath}
        c_{j} = [t^{j}]d(t)= [t^{j}]\frac{1-\sqrt{1-4\,t}}{2\,t}
    \end{displaymath}
    and since $\mathcal{C}$'s $A$-sequence is:
    \begin{displaymath}
        A(t)=\frac{1}{1-t}
    \end{displaymath}
    each coefficient $c_{j}$ combines as follows:
    \begin{displaymath}
        c_{j} = \sum_{k=0}^{j-1}{d_{j-1,k}}
    \end{displaymath}
    in other words, $c_{j}$ equals the $(j-1)$-row sum, therefore:
    \begin{displaymath}
        c_{j} = [t^{j-1}]\mathcal{C}\,A(t)
              = [t^{j-1}]d(t)\,A(h(t))
              = [t^{j}]h(t)\,A(h(t))
              = [t^{j}]\frac{1-\sqrt{1-4 \, t}}{1+\sqrt{1-4 \, t}}
    \end{displaymath}
    although interesting, this result is again difficult to handle.

    Go back to identity:
    \begin{displaymath}
        d_{nk} = \sum_{i_{1}+ i_{2}+ \ldots+ i_{k+1}=n+1}{
                c_{i_{1}-1}\,c_{i_{2}-1}\,\ldots\,c_{i_{k+1}-1} }
    \end{displaymath}
    and write a Catalan coefficient $c_{j}$ in a different form:
    \begin{displaymath}
        c_{j} = \frac{1}{j+1}{{2j}\choose{j}} 
            = {{2j}\choose{j}} - {{2j}\choose{j+1}}
    \end{displaymath}
    and focus on congruences modulo $2$: rewrite $j$ respect base $2$, 
    so there exists $k\in\mathbb{N}$ such that 
    $j=j_{0} + j_{1}\,2 + j_{2}\,2^{2} + \ldots + j_{k}\,2^{k}$, where
    $j_{r}\in\lbrace0,1\rbrace$, for each $r\in\lbrace0,\ldots,k\rbrace$. 
    % now start distinguishing $j$ by cases: if even..., if odd...
    In order to apply Lucas theorem, we proceed by cases on $j$'s parity:
    \begin{itemize}
        \item let $j=2\alpha$, for some $\alpha\in\mathbb{N}$, so $j_{0}=0$,
            which make vanish the minuend:
            \begin{displaymath}
                {{2j}\choose{j+1}}
                \equiv_{2} {{0}\choose{1}}{{0}\choose{j_{1}}}{{j_{1}}\choose{j_{2}}}
                    \ldots{{j_{k-1}}\choose{j_{k}}}{{j_{k}}\choose{0}}\equiv_{2}0
            \end{displaymath}
            so:
            \begin{displaymath}
                c_{2\alpha}\equiv_{2}{{2j}\choose{j}}
                \equiv_{2} {{0}\choose{0}}{{0}\choose{j_{1}}}{{j_{1}}\choose{j_{2}}}
                    \ldots{{j_{k-1}}\choose{j_{k}}}{{j_{k}}\choose{0}}\equiv_{2}0
            \end{displaymath}
            A boundary case pops out when $\alpha=0$, which writes $j$ as 
            $j=0 + 0\cdot2 + 0\cdot2^{2} + \ldots + 0\cdot2^{k}$, therefore:
            \begin{displaymath}
                c_{0}\equiv_{2}{{0}\choose{0}}
                \equiv_{2} {{0}\choose{0}}{{0}\choose{0}}{{0}\choose{0}}
                    \ldots{{0}\choose{0}}{{0}\choose{0}}\equiv_{2}1
            \end{displaymath}
            this is indeed the only case to have $c_{2\alpha} \equiv_{p}1$,
            as the following proof confirms:
            \begin{proof}
                Assume not, hence there exists $\hat{\alpha}\in\mathbb{N}$, greater than $0$,
                such that $c_{2\hat{\alpha}} \equiv_{p}1$. So to don't make ${{0}\choose{j_{1}}}$
                be zero then $j_{1}=0$; in turn this constraint requires a new one, namely
                to don't make ${{0}\choose{j_{2}}}$ be zero then $j_{2}=0$; 
                in turn this constraint requires a new one, namely
                to don't make ${{0}\choose{j_{3}}}$ be zero then $j_{3}=0$; 
                in turn this constraint requires a new one, namely\ldots
                to don't make ${{0}\choose{j_{k}}}$ be zero then $j_{k}=0$.
                Therefore $j=0$ which contradicts the hypothesis $\alpha>0$, so
                for even $j > 0$ coefficient $c_{j}\equiv_{p}0$, as required.
            \end{proof}

        \item let $j=2\alpha+1$, for some $\alpha\in\mathbb{N}$, so $j_{0}=1$,
            which make vanish the augend:
            \begin{displaymath}
                {{2j}\choose{j}}
                \equiv_{2} {{0}\choose{1}}{{1}\choose{j_{1}}}{{j_{1}}\choose{j_{2}}}
                    \ldots{{j_{k-1}}\choose{j_{k}}}{{j_{k}}\choose{0}}\equiv_{2}0
            \end{displaymath}
            so:
            \begin{displaymath}
                c_{2\alpha+1}\equiv_{2}-{{2j}\choose{j+1}}
                %\equiv_{2} {{0}\choose{0}}{{0}\choose{j_{1}}}{{j_{1}}\choose{j_{2}}}
                    %\ldots{{j_{k-1}}\choose{j_{k}}}{{j_{k}}\choose{0}}\equiv_{2}0
            \end{displaymath}
            observe that $(-1)^{-1}\mod2$, the multiplicative inverse of $-1$, equals $1$
            since $(-1)\cdot 1 \equiv_{2}1$, therefore we can multiply both members by
            $(-1)^{-1}\mod2$ to get:
            \begin{displaymath}
                c_{2\alpha+1}\equiv_{2}{{2j}\choose{j+1}}
                %\equiv_{2} {{0}\choose{0}}{{0}\choose{j_{1}}}{{j_{1}}\choose{j_{2}}}
                    %\ldots{{j_{k-1}}\choose{j_{k}}}{{j_{k}}\choose{0}}\equiv_{2}0
            \end{displaymath}

            Be careful handling $j+1$, since $j$ is odd a possible chain of carries
            may happen, so handle in a generic way, writing
            the generic representation of $j$ in base $2$, putting evidence on coefficients:
            \begin{displaymath}
                j=\left(\underbrace{1,1,\ldots,1}_{\beta},0,j_{\beta+1},\ldots,j_{\beta+\gamma}\right)_{2}
            \end{displaymath}
            where $\beta,\gamma\in\mathbb{N}$ such that $\beta>0$ and $\beta+\gamma=k$. 
            
            Now increment by $1$:
            \begin{displaymath}
                j+1=\left(\underbrace{0,0,\ldots,0}_{\beta},1,j_{\beta+1},\ldots,j_{\beta+\gamma}%,j_{\beta+\gamma+1}
                    \right)_{2}
            \end{displaymath}
            so the congruence relation gets the following shape:
            \begin{displaymath}
                c_{2\alpha+1}\equiv_{2}{{2j}\choose{j+1}}
                    \equiv_{2} \underbrace{{{0}\choose{0}}{{1}\choose{0}}{{1}\choose{0}}\ldots{{1}\choose{0}}}_{\beta} 
                        {{1}\choose{1}}{{0}\choose{j_{\beta+1}}}
                        \ldots{{j_{\beta+\gamma-1}}\choose{j_{\beta+\gamma}}}{{j_{\beta+\gamma}}\choose{0}}%{\beta+\gamma+1}}
            \end{displaymath}
            a simplification yield:
            \begin{displaymath}
                c_{2\alpha+1}\equiv_{2} {{0}\choose{j_{\beta+1}}}
                        \ldots{{j_{\beta+\gamma-1}}\choose{j_{\beta+\gamma}}}
            \end{displaymath}
            so $c_{2\alpha+1}\equiv_{2} 1$ if coefficients $j_{\beta+1}, \ldots, j_{\beta+\gamma-1},j_{\beta+\gamma}$
            are $0$ them all, which implies that:
            \begin{displaymath}
                j=\left(\underbrace{1,1,\ldots,1}_{\beta},\underbrace{0,0,\ldots,0}_{k-\beta+1}\right)_{2}
            \end{displaymath}
            in other words $j = 2^{\beta+1}-1$. As boundary case, to handle $c_{1}$ correctly 
            (the above result doesn't cover it because $\beta>0$) observe:
            \begin{displaymath}
                c_{1}\equiv_{2} {{2}\choose{2}}\equiv_{2} {{0}\choose{0}}{{1}\choose{1}}\equiv_{2}1
            \end{displaymath}
            the moral is: for $j$ odd, $c_{j} \equiv_{p} 1$ if $j$ is one less a power of $2$. 
    \end{itemize}

    It is interesting to observe that if we use the ``traditional'' characterization
    of a Catalan coefficient $c_{j}$:
    \begin{displaymath}
        (j+1)\,c_{j} = {{2j}\choose{j}} 
    \end{displaymath}
    the case about $j$ odd, $j=2\alpha+1$, would've been hard to handle, because:
    \begin{displaymath}
        2(\alpha+1)\,c_{j}\equiv_{2} {{0}\choose{1}}{{1}\choose{j_{1}}}
                \ldots{{j_{k-1}}\choose{j_{k}}}
    \end{displaymath}
    reduces to $0\equiv_{2}0$ identity, giving no opportunity to derive some
    properties about coefficient $c_{j}$.
    \\\\
    Now we're ready to tackle the formalization of ``modular'' obsersations
    made some paragraphs ago.

    For instance, why coefficients lying on a row $2^{\alpha}-1$, for
    some $\alpha\in\mathbb{N}$, are odd them all?
    \begin{proof}
        For the one on the very left, namely $d_{2^{\alpha}-1,0}$, we now
        directly from the above derivation that $d_{2^{\alpha}-1,0}\equiv_{2}1$. What about $d_{2^{\alpha}-1,1}$?
        Recall we can write it as:
        \begin{displaymath}
            d_{2^{\alpha}-1,1} = \sum_{i_{1}+ i_{2}=2^{\alpha}}{ c_{i_{1}-1}\,c_{i_{2}-1} }
        \end{displaymath}
        observe how indices $i_{1}, i_{2}$ are related: $i_{1}+ i_{2}=2^{\alpha}$,
        so $2^{\alpha}$ divides $i_{1}+i_{2}$ \emph{exactly}.
        %, which is the same to say that 
        %$\frac{i_{1}}{2^{\alpha}}$ and $\frac{i_{2}}{2^{\alpha}}$ are both integers.
        This implies that there exists $\beta,\gamma\in\mathbb{N}$, where $\beta,\gamma\leq\alpha$,
        such that $i_{1}=2^{\beta}$ and $i_{2}=2^{\gamma}$, respectively, since both indices
        cannot exceed $2^{\alpha}$.

        By this fact follows that $c_{i_{1}-1}=c_{2^{\beta}-1}\equiv_{2}1$ and 
        $c_{i_{2}-1}=c_{2^{\gamma}-1}\equiv_{2}1$, moreover $c_{i_{1}-1}\,c_{i_{2}-1}\equiv_{2}1$.
        By construction $i_{1},i_{2}\in\lbrace0,\ldots,2^{\alpha}\rbrace$, fixing one of them in 
        $i_{1}+ i_{2}=2^{\alpha}$ fixes the other as well, with $2^{\alpha}+1$ available choices.
        We're almost finished:
        \begin{displaymath}
            d_{2^{\alpha}-1,1} = \sum_{i_{1}+ i_{2}=2^{\alpha}}{ c_{i_{1}-1}\,c_{i_{2}-1} }
                \equiv_{2} \sum_{k=1}^{2^{\alpha}+1}{1}\equiv_{2} 2^{\alpha}+1\equiv_{2} 1
        \end{displaymath}

        What about the general case, namely for coefficient $d_{2^{\alpha}-1,s}$, where
        $s\in\lbrace{2,\ldots,2^{\alpha}-1}\rbrace$?  Recall we can write it as:
        \begin{displaymath}
            d_{2^{\alpha}-1,s} = \sum_{i_{1}+i_{2}+\ldots+i_{s+1}=2^{\alpha}}
                {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{s+1}-1}}
        \end{displaymath}
        Using an argument similar the previous one, we get that $c_{i_{j}-1}\equiv_{2}1$,
        for $j\in\lbrace1,\ldots,s+1\rbrace$, rewrite as follow:
        \begin{displaymath}
            d_{2^{\alpha}-1,s} \equiv_{2} \sum_{i_{1}+i_{2}+\ldots+i_{s+1}=2^{\alpha}}{1}
                \equiv_{2} {{s+2^{\alpha}}\choose{2^{\alpha}}}
        \end{displaymath}
        because the summation over indices $i_{1},\ldots,i_{s+1}$ asks to 
        count the number of $2^{\alpha}$-combinations of $s+1$ distinct objects,
        each of which may appear indefinitely often, that is, $0$ to $2^{\alpha}$
        times: the saught number is ${{(s+1)+2^{\alpha}-1}\choose{2^{\alpha}}}$.

        Again, we're interested on the parity of such coefficient, therefore
        write $s=s_{0}+s_{1}\,2+\ldots+s_{\alpha-1}\,2^{\alpha-1}$, because $s$ can equal 
        $2^{\alpha}-1$ at most, and apply Lucas theorem one more time:
        \begin{displaymath}
            {{s+2^{\alpha}}\choose{2^{\alpha}}}\equiv_{2} 
                {{s_{0}}\choose{0}}{{s_{1}}\choose{0}} \ldots
                    {{s_{\alpha-1}}\choose{0}}{{1}\choose{0}}\equiv_{2}1 
        \end{displaymath}
        the general case holds too, therefore each coefficient lying on
        a row $2^{\alpha}-1$ is odd, as required.
    \end{proof}

    Another question: 
    \begin{quote}
        why each coefficient lying on the segment 
        $S=\lbrace2^{\alpha},\ldots,2^{\alpha+1}-2\rbrace$ of column 
        $2^{\alpha}-1$, namely $d_{s,2^{\alpha}-1}$ for $s\in S$, is even?
    \end{quote}
    \begin{proof}
    As before, try to use our definition:
    \begin{displaymath}
        d_{s, 2^{\alpha}-1} = \sum_{i_{1}+i_{2}+\ldots+i_{2^{\alpha}}=s+1}
            {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}}-1}}
    \end{displaymath}
    Observe that in this case, the number of Catalan coefficients
    multiplied together in each summand is the same, namely $2^{\alpha}$,
    for any $s\in S$; what changes respect to $s$ is the set of values 
    each $i_{j}$ can take. Look at the following table:
    \begin{displaymath}
        \begin{array}{rcc}
            s = 2^{\alpha} \rightarrow
                & i_{j}\in\lbrace0,\ldots,2^{\alpha}+1\rbrace 
                & c_{k}\in\lbrace c_{-1},\ldots,c_{2^{\alpha}}\rbrace\\
            s = 2^{\alpha} +1\rightarrow
                & i_{j}\in\lbrace0,\ldots,2^{\alpha}+2\rbrace 
                & c_{k}\in\lbrace c_{-1},\ldots,c_{2^{\alpha}+1}\rbrace\\
            \vdots & & \\
            s = 2^{\alpha+1} -2\rightarrow
                & i_{j}\in\lbrace0,\ldots,2^{\alpha+1}-1\rbrace 
                & c_{k}\in\lbrace c_{-1},\ldots,c_{2^{\alpha+1}-2}\rbrace\\
        \end{array}
    \end{displaymath}
    therefore, for any $s\in S$, the bigger set of Catalan coefficients we have 
    to consider is $\Omega = \lbrace c_{-1},\ldots,c_{2^{\alpha}-1},c_{2^{\alpha}},\ldots,c_{2^{\alpha+1}-2}\rbrace$.
    Each coefficient $c_{j}\in\Omega$ is even except those of the form $c_{2^{\beta}-1}$, which are odd,
    and they are $\lbrace c_{2^{\alpha-(\alpha-1)}-1},c_{2^{\alpha-(\alpha-2)}-1},\ldots, 
        c_{2^{\alpha-1}-1},c_{2^{\alpha}-1}\rbrace$, $\alpha$ in number.
    Since each summand $t=c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}}-1}$ 
    has $2^{\alpha}$ coefficients, no matter if $t$ contains each coefficient in $\Omega$,
    the remaining ones make it vanish and $ d_{s, 2^{\alpha}-1} \equiv_{2} 0$, for any $s\in S$,
    as required.

    \end{proof}

    Another question, this one should be interpreted keeping the
    concept of principal $h$-cluster in mind:
    \begin{quote}
        show that an equilateral triangle $T_{\equiv_{2} 0}^{(h)}$, 
        for some $h\in\mathbb{N}$,
        with $2^{h}-1$ coefficients on each side, satisfies:
        \begin{displaymath}
            d_{nk} \in T_{\equiv_{2} 0}^{(h)} \rightarrow d_{nk} \equiv_{2} 0
        \end{displaymath}
        where $n\in\lbrace 2^{h},\ldots,2^{h+1}-2\rbrace$ and 
        $k\in\lbrace 0,\ldots, n-2^{h}\rbrace$, in other words
        $k\in\lbrace 0,\ldots, 2^{h}-2\rbrace$. Note that triangle
        $T_{\equiv_{2} 0}^{(h)}$ is a component of the principal cluster
        of order $h+1$.
    \end{quote}
    \begin{proof}
    In order to answer this question we repeatedly use the approach
    of the previous proof, considering columns $\Xi=\lbrace 0,\ldots, 2^{h}-2\rbrace$ and
    for each column $k\in\Xi$, the segment $S_{k}=\lbrace2^{h}+k,\ldots,2^{h+1}-2 \rbrace$.

    Everything is set, so start from column on the very left, column $k=0$.
    So the corresponding segment $S_{0}=\lbrace2^{h},\ldots,2^{h+1}-2 \rbrace$ is
    a segment of ``traditional'' Catalan coefficients because coefficients lying on
    column $0$ are defined by generating function $d_{\mathcal{C}}$. Since no
    coefficient has the shape $c_{2^{\alpha}-1}$, all such coefficients are even.

    Go ahead with column $k=1$, so the corresponding segment is 
    $S_{1}=\lbrace2^{h}+1,\ldots,2^{h+1}-2 \rbrace$ and coefficient lying on it
    are defined according:
    \begin{displaymath}
        d_{s, 1} = \sum_{i_{1}+i_{2}=s+1} {c_{i_{1}-1}\,c_{i_{2}-1}}
    \end{displaymath}
    where $s\in S_{1}$. This is quite similar to the proof developed before,
    with the difference to have summand term $t$ with two coefficient, namely
    $t=c_{i_{1}-1}\,c_{i_{2}-1}$ instead of $2^{h}$, therefore the same argument applies,
    since if having $2^{h}$ possible choices of coefficients fails to make not vanish
    the summand $t$, modulo $2$, the same failure is reached if we have only $2$ possible choices.

    The same reasoning holds for remaining columns $\lbrace 2,\ldots, 2^{h}-2\rbrace$,
    since the above proof covers upto column $2^{h}-1$, hence the triangle $T_{\equiv_{2} 0}^{(h)}$
    contains only even coefficients, as required.

    \end{proof}

    In order to prove that the triangle in the middle within the ``bottom strip'' 
    of a principal $(h+1)$-cluster and the triangle on the very right 
    ``mirror'' each other, reason as follow. 
    
    Fix a coefficient lying on
    column $2^{h}-1$ within segment $S_{2^{h}-1}=\lbrace 2^{h}+1,\ldots,2^{h+1}-2 \rbrace$,
    denote this coefficient $\hat{d}_{s,2^{h}-1}$, where $s\in S_{2^{h}-1}$. The
    request can be formalized as follow:
    \begin{displaymath}
        d_{s-e,2^{h}-1-e} \equiv_{2} d_{s,2^{h}-1+e}
    \end{displaymath}
    for $e\in\lbrace1,\ldots,s-(2^{h}-1)-1\rbrace=\lbrace1,\ldots,s-2^{h}\rbrace$,
    computed looking at row $s$ toward its end.
    Using our definition we can rewrite as:

    \begin{lenghtydisplaymath}
        \sum_{i_{1}+i_{2}+\ldots+i_{2^{\alpha}-e}=s-e+1}
            {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}-e}-1}}
        \equiv_{2}
        \sum_{i_{1}+i_{2}+\ldots+i_{2^{\alpha}+e}=s+1}
            {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}+e}-1}}
    \end{lenghtydisplaymath}

    Panic! No idea to tackle the general setting as a whole. So, start small.
    Let $s=2^{h}+1$, therefore no choices for $e$, obliged $e=1$, so:

    \begin{lenghtydisplaymath}
        \sum_{i_{1}+i_{2}+\ldots+i_{2^{\alpha}-1}=2^{h}+1}
            {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}-1}-1}}
        \equiv_{2}
        \sum_{i_{1}+i_{2}+\ldots+i_{2^{\alpha}+1}=2^{h}+2}
            {c_{i_{1}-1}\,c_{i_{2}-1}\ldots\,c_{i_{2^{\alpha}+1}-1}}
    \end{lenghtydisplaymath}

    too difficult to proceed this way, sadly. 
    
    Another idea could be to
    translate back columns (discarding unnecessary coefficients by subtracting them)
    on the \emph{left} of the choosen ``pivot'' element $\hat{d}_{s,2^{h}-1}$. 
    In this way columns should be congruent element-wise but, again, it seems difficult
    to move forward this way.

    Another approach is to find a closed form for a coefficient in $\mathcal{C}$,
    using extract operator: $d_{nk} = [t^{n}]d_{\mathcal{C}}(t)h_{\mathcal{C}}(t)^{k}$.
    According the article \emph{Identities induced by Riordan Arrays}, such
    coefficient $d_{nk}$ agrees with:
    \begin{displaymath}
        d_{nk}=\frac{k+1}{n+1}{{2n-k}\choose{n-k}}
    \end{displaymath}
        \marginpar{in these ``modular''
            proofs it's much easier to rewrite a binomial coefficient
            into other binomial coefficients, only}
    or else:
    \begin{displaymath}
        d_{nk}={{2n-k}\choose{n-k}} - {{2n-k}\choose{n-k-1}}
    \end{displaymath}

    We attempt a \emph{false start} using the former definition.
    \begin{proof}
    Assume not, therefore we need to prove the following statement:
    \begin{displaymath}
        d_{s-e,2^{h}-1-e} \not\equiv_{2} d_{s,2^{h}-1+e}
    \end{displaymath}
    rewriting the congruence according the former definition for $d_{nk}$:
    \begin{displaymath}
        \frac{2^{h}-e}{s-e+1}{{2(s-e)-(2^{h}-1-e)}\choose{s-e-(2^{h}-1-e)}}
        \not\equiv_{2}
        \frac{2^{h}+e}{s+1}{{2s-(2^{h}-1+e)}\choose{s-(2^{h}-1+e)}}
    \end{displaymath}
    simplify it:
    \begin{displaymath}
        \frac{2^{h}-e}{s-e+1}{{2s-e-2^{h}+1}\choose{s-2^{h}+1}}
        \not\equiv_{2}
        \frac{2^{h}+e}{s+1}{{2s-2^{h}+1-e}\choose{s-2^{h}+1-e}}
    \end{displaymath}
    manipulate using ${{n}\choose{k}}={{n}\choose{n-k}}$:
    \begin{displaymath}
        \frac{2^{h}-e}{s-e+1}{{2s-e-2^{h}+1}\choose{s-e}}
        \not\equiv_{2}
        \frac{2^{h}+e}{s+1}{{2s-2^{h}+1-e}\choose{s}}
    \end{displaymath}
    dead end: nonetheless binomial coeffients allow some grunging,
    fractions on both side are difficult to handle since it's hard
    to find their multiplicative inverses, modulo $2$.
    \end{proof} 
    
    Trace back to the latter closed formula for coefficient $d_{nk}$. 
    \begin{proof}
    Recall we would like to prove the following statement:
    \begin{displaymath}
        d_{s-e,2^{h}-1-e} \equiv_{2} d_{s,2^{h}-1+e}
    \end{displaymath}
    Rewrite the left hand side:
    \begin{displaymath}
        d_{s-e,2^{h}-1-e}= {{2(s-e)-(2^{h}-1-e)}\choose{(s-e)-(2^{h}-1-e)}}
            - {{2(s-e)-(2^{h}-1-e)}\choose{(s-e)-(2^{h}-1-e)-1}}
    \end{displaymath}
    in the same spirit, rewrite the right hand side:
    \begin{displaymath}
        d_{s,2^{h}-1+e}={{2s-(2^{h}-1+e)}\choose{s-(2^{h}-1+e)}}
            - {{2s-(2^{h}-1+e)}\choose{s-(2^{h}-1+e)-1}}
    \end{displaymath}
    therefore:
    \begin{displaymath}
        \begin{split}
            {{2s-e-2^{h}+1}\choose{s-2^{h}+1}}
                - {{2s-e-2^{h}+1}\choose{s-2^{h}}}
            &\equiv_{2}
            {{2s-2^{h}+1-e}\choose{s-2^{h}+1-e}}
                - {{2s-2^{h}+1-e}\choose{s-2^{h}-e}}\\
            {{2s-e-2^{h}+1}\choose{s-e}}
                - {{2s-e-2^{h}+1}\choose{s-e+1}}
            &\equiv_{2}
            {{2s-2^{h}+1-e}\choose{s}}
                - {{2s-2^{h}+1-e}\choose{s+1}}\\
        \end{split}
    \end{displaymath}

    Since $e\in\lbrace1,\ldots,s-2^{h}\rbrace$, proceed by complete induction on $e$:
    \begin{itemize}
        \item base case $e=1$ yield the following congruence:
            \begin{displaymath}
                    {{2s-2^{h}}\choose{s-1}}-{{2s-2^{h}}\choose{s}}
                    \equiv_{2}
                    {{2s-2^{h}}\choose{s}}-{{2s-2^{h}}\choose{s+1}}\\
            \end{displaymath}
            which is the same to say:
            \begin{displaymath}
                    {{2s-2^{h}}\choose{s-1}}+{{2s-2^{h}}\choose{s+1}} \equiv_{2} 0
            \end{displaymath}
            let $s=s_{0}+s_{1}\,2+s_{2}\,2^{2}+\ldots+s_{h-1}\,2^{h-1} + 2^{h}$
            be the generic representation of $s$ in base $2$, since 
            $s\in\lbrace 2^{h}+1,\ldots,2^{h+1}-2 \rbrace$; also  
            let $2s-2^{h}=s_{0}\,2+s_{1}\,2^{2}+s_{2}\,2^{3}+\ldots+s_{h-1}^{*}\,2^{h} + s_{h}^{*}\,2^{h+1}$,
            where $(s_{h-1}^{*},s_{h}^{*})$ equals $(0,1)$ if $s_{h-1}=1$, otherwise equals $(1,0)$.
            By cases on the parity of $s$:
            \begin{itemize}
                \item assume $s$ even, therefore both $s-1$ both $s+1$ are odd, 
                    let $\hat{s}=1+\hat{s}_{1}\,2+\hat{s}_{2}\,2^{2}+\ldots+
                        \hat{s}_{h-1}\,2^{h-1}+2^{h}$ be one of them, hence:
                    \begin{displaymath}
                            {{2s-2^{h}}\choose{\hat{s}}}  
                            \equiv_{2}
                            {{0}\choose{1}} 
                            {{0}\choose{\hat{s}_{1}}}
                            {{s_{1}}\choose{\hat{s}_{2}}}
                            \ldots
                            {{s_{h-2}}\choose{\hat{s}_{h-1}}}
                            {{s_{h-1}^{*}}\choose{1}}
                            {{s_{h}^{*}}\choose{0}} = 0
                    \end{displaymath}
                    Observe $\hat{s}_{h}=1$ against boundary cases:
                    if $s=2^{h}+1$ then $\hat{s}=s-1=2^{h}$, on the other
                    hand if $s=2^{h+1}-2$ then $\hat{s}=s+1=2^{h+1}-1$,
                    therefore in both cases the coefficient of $2^{h}$ is $1$.
                    Eventually we get $0+0 \equiv_{2}0$, which holds;

                \item assume $s$ odd, therefore both $s-1$ both $s+1$ are even, 
                    let's study the former:
                    \begin{displaymath}
                            {{2s-2^{h}}\choose{s-1}}  
                            \equiv_{2}
                            {{0}\choose{0}} 
                            {{1}\choose{s_{1}}}
                            {{s_{1}}\choose{s_{2}}}
                            \ldots
                            {{s_{h-2}}\choose{s_{h-1}}}
                            {{s_{h-1}^{*}}\choose{1}}
                            {{s_{h}^{*}}\choose{0}}
                    \end{displaymath}
                    in order for the right hand side to not vanish, modulo $2$,
                    it is mandatory for coefficients $\lbrace s_{i}\rbrace_{i\in\lbrace1,\ldots,h-2\rbrace}$
                    to satisfy $s_{i}\geq s_{i+1}$: if any one of them is $0$, say $s_{j}$, then
                    $s_{j+1},\ldots,s_{j+k}$, with $j+k=h-1$,
                    have to be all $0$ too. In particular, if $s_{h-1}=0$ then 
                    $(s_{h-1}^{*},s_{h}^{*})=(1,0)$
                    therefore the right hand side reduces to $1$, modulo $2$.
                    Observe that coefficients $\lbrace s_{i}\rbrace_{i\in\lbrace1,\ldots,h-2\rbrace}$
                    cannot be all $1$ otherwise 
                    $s=(\underbrace{1,1,1,\ldots,1}_{h+1})_{2}=2^{h+1}-1$ raises a contraddiction, because
                    $s$ can assume $2^{h+1}-2$ at most. 
                    
                    For the latter, namely $s+1$, assume $s$ can be represented as 
                    $(\underbrace{1,1,\ldots,1}_{r},0,s_{r+1},s_{r+2},\ldots,s_{h-1},1)_{2}$, for
                    $r\in\lbrace1,\ldots,h-2\rbrace$, since a $0$ must occur otherwise $s=2^{h+1}-1$
                    which cannot be the case, as we've already seen.  Adding $1$ yield the representation
                    $(\underbrace{0,0,\ldots,0}_{r},1,s_{r+1},s_{r+2},\ldots,s_{h-1},1)_{2}$, therefore:
                    \begin{lenghtydisplaymath}
                            {{2s-2^{h}}\choose{s+1}} 
                            \equiv_{2} 
                            \underbrace{
                                {{0}\choose{0}} 
                                {{1}\choose{0}}
                                {{1}\choose{0}}
                                \ldots
                                {{1}\choose{0}}
                            }_{r}
                            {{1}\choose{1}}
                            {{0}\choose{s_{r+1}}}
                            {{s_{r+1}}\choose{s_{r+2}}}
                            \ldots
                            {{s_{h-2}}\choose{s_{h-1}}}
                            {{s_{h-1}^{*}}\choose{1}}
                            {{s_{h}^{*}}\choose{0}}
                    \end{lenghtydisplaymath}
                    In order to not vanish, modulo $2$, 
                    $s_{r+1}=0$, this propagates in turn that $s_{r+2}=0$, \ldots, 
                    this propagates in turn that $s_{h-2}=0$,
                    this propagates in turn that $s_{h-1}=0$. But if $s_{h-1}=0$
                    then $(s_{h-1}^{*},s_{h}^{*})=(1,0)$, therefore the right
                    hand side reduces to $1$.

                    Combining the above cases for $s$ odd we reach:
                    \begin{displaymath}
                            {{2s-2^{h}}\choose{s-1}}+{{2s-2^{h}}\choose{s+1}} \equiv_{2} 1+1\equiv_{2} 0
                    \end{displaymath}
            \end{itemize}

            \item assume the argument holds for $k\leq e$ and prove for $k=e+1$, so we need to show:

                \begin{lenghtydisplaymath}
                    \begin{split}
                        {{2s-(e+1)-2^{h}+1}\choose{s-2^{h}+1}}
                            - {{2s-(e+1)-2^{h}+1}\choose{s-2^{h}}}
                        &\equiv_{2}
                        {{2s-2^{h}+1-(e+1)}\choose{s-2^{h}+1-(e+1)}}
                            - {{2s-2^{h}+1-(e+1)}\choose{s-2^{h}-(e+1)}}\\
                        {{2s-(e+1)-2^{h}+1}\choose{s-(e+1)}}
                            - {{2s-(e+1)-2^{h}+1}\choose{s-(e+1)+1}}
                        &\not\equiv_{2}
                        {{2s-2^{h}+1-(e+1)}\choose{s}}
                            - {{2s-2^{h}+1-(e+1)}\choose{s+1}}\\
                        {{2s-e-2^{h}}\choose{s-e-1}}
                            - {{2s-e-2^{h}}\choose{s-e}}
                        &\not\equiv_{2}
                        {{2s-2^{h}-e}\choose{s}}
                            - {{2s-2^{h}-e}\choose{s+1}}\\
                    \end{split}
                \end{lenghtydisplaymath}
                which follows directly by complete induction hypothesis.
    \end{itemize}

    \end{proof}


    In order to fully characterize $\mathcal{C}$ in a modular context we're
    left with a last question:
    \begin{quote}
        consider a principal $(h+1)$-cluster $\mathcal{C}_{h+1}$: is the subcluster
        $\mathcal{C}_{h}^{(0,p^{h}-1)}$ congruent to the subtriangle on the
        very right in the ``bottom strip'' of $\mathcal{C}_{h+1}$?
    \end{quote}

    In order to formally state the above question we reason as before, choosing
    a ``pivot'' element lying on a segment of column $2^{h}-1$, so 
    denote with $S_{2^{h}-1}=\lbrace 2^{h}+1,\ldots,2^{h+1}-2 \rbrace$ the segment
    of such column and let coefficient $\hat{d}_{s,2^{h}-1}$, where $s\in S_{2^{h}-1}$,
    be the ``pivot'' element. The request can be formalized as follow:
    \begin{displaymath}
        d_{s,2^{h}-1+e} \equiv_{2} d_{s-2^{h},e-1}
    \end{displaymath}
    for $e\in\lbrace1,\ldots,s-(2^{h}-1)-1\rbrace=\lbrace1,\ldots,s-2^{h}\rbrace$,
    computed looking at row $s$ toward its end.

    \begin{proof}
    We tackle the proof using the following definition for $d_{nk}\in\mathcal{C}$:
    \begin{displaymath}
        d_{nk}={{2n-k}\choose{n-k}} - {{2n-k}\choose{n-k-1}}
    \end{displaymath}
    instantiated with our indices, we have to prove:

    \begin{lenghtydisplaymath}
        \begin{split}
            {{2s-(2^{h}-1+e)}\choose{s-(2^{h}-1+e)}} - {{2s-(2^{h}-1+e)}\choose{s-(2^{h}-1+e)-1}}
            &\equiv_{2}
            {{2(s-2^{h})-(e-1)}\choose{(s-2^{h})-(e-1)}} - {{2(s-2^{h})-(e-1)}\choose{(s-2^{h})-(e-1)-1}}\\
            {{2s-2^{h}+1-e}\choose{s-2^{h}+1-e}} - {{2s-2^{h}+1-e}\choose{s-2^{h}-e}}
            &\equiv_{2}
            {{2s-2^{h+1}-e+1}\choose{s-2^{h}-e+1}} - {{2s-2^{h+1}-e+1}\choose{s-2^{h}-e}}\\
            {{2s-2^{h}+1-e}\choose{s}} - {{2s-2^{h}+1-e}\choose{s+1}}
            &\equiv_{2}
            {{2s-2^{h+1}-e+1}\choose{s-2^{h}}} - {{2s-2^{h+1}-e+1}\choose{s-2^{h}+1}}\\
        \end{split}
    \end{lenghtydisplaymath}
    Since $e\in\lbrace1,\ldots,s-2^{h}\rbrace$, proceed by complete induction on $e$:
        \begin{itemize}
            \item base case $e=1$ therefore:

                \begin{lenghtydisplaymath}
                    \begin{split}
                        {{2s-2^{h}}\choose{s}} - {{2s-2^{h}}\choose{s+1}}
                        &\equiv_{2}
                        {{2s-2^{h+1}}\choose{s-2^{h}}} - {{2s-2^{h+1}}\choose{s-2^{h}+1}}\\
                    \end{split}
                \end{lenghtydisplaymath}
                In the previous proof a detailed (and boring) derivation has been performed,
                here we observe that upper terms of each binomial coefficient, $2s-2^{h}$
                and $2s-2^{h+1}$ respectively, have $2$ in their prime factorization, therefore
                expanding each binomial, $2$ can be factored out in turn, making congruent $0$
                each one of them. However an approach similar to the previous one can be
                taken as well.

            \item assume the argument holds for $k\leq e$ and prove for $k=e+1$, so we need to show:

                \begin{lenghtydisplaymath}
                    \begin{split}
                        {{2s-2^{h}+1-(e+1)}\choose{s}} - {{2s-2^{h}+1-(e+1)}\choose{s+1}}
                        &\equiv_{2}
                        {{2s-2^{h+1}-(e+1)+1}\choose{s-2^{h}}} - {{2s-2^{h+1}-(e+1)+1}\choose{s-2^{h}+1}}\\
                        {{2s-2^{h}-e}\choose{s}} - {{2s-2^{h}-e}\choose{s+1}}
                        &\equiv_{2}
                        {{2s-2^{h+1}-e}\choose{s-2^{h}}} - {{2s-2^{h+1}-e}\choose{s-2^{h}+1}}\\
                    \end{split}
                \end{lenghtydisplaymath}
                which follows directly by complete induction hypothesis.
        \end{itemize}
    \end{proof}
   
    Before concluding this section, we would like to note that the last two
    proofs doesn't say anything about the remainder of a coefficient belonging
    to subtriangles of interest: we've shown only that a \emph{complete}
    subtriangle is repeated when coefficients are taken modulo $2$. 

    Enough for this characterization modulo $2$ for Catalan array $\mathcal{C}$.

    \subsection{Expanded arrays and coloured triangles}

    Expansion of Riordan array $\mathcal{C}$:
    \input{../sympy/catalan/Catalan-traditional-standard-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
    Expansion of Riordan array $\mathcal{C}^{-1}$:
    \input{../sympy/catalan/Catalan-traditional-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}

    \input{../sympy/catalan/Catalan-traditional-standard-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/catalan/Catalan-traditional-inverse-handle-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \subsection{Sprugnoli and He version}

    Expansion of Riordan array $\mathcal{C}$:
    \input{../sympy/catalan/catalan-sprugnoli-he-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
    Expansion of Riordan array $\mathcal{C}^{-1}$:
    \input{../sympy/catalan/catalan-sprugnoli-he-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}

    \input{../sympy/catalan/catalan-sprugnoli-he-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/catalan/catalan-sprugnoli-he-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/catalan/Catalan-standard-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/catalan/Catalan-inverse-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \subsection{Minor variants: triangles $\mathcal{S}, \mathcal{C}$ and $\mathcal{B}$}

    Expansion of Riordan array $\mathcal{S}$:
    \input{../sympy/catalan-like/catalan-variant-s-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{S}^{-1}$:
    \input{../sympy/catalan-like/catalan-variant-s-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{C}$:
    \input{../sympy/catalan-like/catalan-variant-c-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{C}^{-1}$:
    \input{../sympy/catalan-like/catalan-variant-c-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{B}$:
    \input{../sympy/catalan-like/catalan-variant-b-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{B}^{\diamond}$:
    \input{../sympy/catalan-like/catalan-variant-b-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}

    \input{../sympy/catalan-like/catalan-variant-s-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/catalan-like/catalan-variant-s-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/catalan-like/catalan-variant-c-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/catalan-like/catalan-variant-c-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/catalan-like/catalan-variant-b-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/catalan-like/catalan-variant-b-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}

    \section{Motzkin}

    \added[id=sid]{A possible recurrence should be the following, inspired by the 
    computation of the \emph{fractal dimensionality} of Pascal array:}
    \begin{displaymath}
        \added[id=sid]{\mathcal{M}(h+2) = 2\,\left(\mathcal{M}(h+1) + \mathcal{M}(h)\right)}
    \end{displaymath}
    \added[id=sid]{
    It is derived according the following reasoning. Let $\mathcal{M}_{h}$
    be the principal cluster of order $h$. Looking at the drawn triangle,
    we observe that cluster $\mathcal{M}_{h+2}$ is composed as follows:}
    \begin{itemize}
        \item \added[id=sid]{$\mathcal{M}_{h}$ repeats two times ``over the same columns'';}
        \item \added[id=sid]{$\mathcal{M}_{h+1}$ repeats two times: the first one covers the
            very top position, therefore from column $0$ to column $p^{h+1}-1$, included;
            the second one covers ``right-most columns'', 
            specifically covers from column $p^{h+1}$ to column $p^{h+2}-1$, included;}
        \item \added[id=sid]{two upside-down triangles (ie. pointing downward), of coefficients
            which prime $p$ divides, are introduced
            but they don't seem releated with the ones present in clusters 
            $\mathcal{M}_{h}$ and $\mathcal{M}_{h+1}$;}
        \item \added[id=sid]{another two triangles, with mixed coefficients, some of them
            are multiple of $p$, some aren't: however the two copies look similar.
            These two copies sit on the left of cluster $\mathcal{M}_{h+1}$ and
            are separated from it by a ``segment'' of coefficients (all even but
            the very first and the very last) lying on column $p^{h+1}-1$.}
    \end{itemize}
    \added[id=sid]{
    We need to be more precise about involved rows, nonetheless the very first
    antidiagonal plays a misleading role, since it is composed by $1$s only,
    and if we consider it, the previous points aren't ultimately correct,
    especially the repetitions of cluster $\mathcal{M}_{h}$.}

    Expansion of Riordan array $\mathcal{M}$:
    \input{../sympy/motzkin/motzkin-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{M}^{\diamond}$:
    \input{../sympy/motzkin/motzkin-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{T}$:
    \input{../sympy/motzkin/motzkin-variant-t-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{T}^{-1}$:
    \input{../sympy/motzkin/motzkin-variant-t-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{T}^{\perp}$:
    \input{../sympy/motzkin/motzkin-variant-t-perp-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}
    Expansion of Riordan array $\mathcal{T}^{\diamond}$:
    \input{../sympy/motzkin/motzkin-variant-t-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix}

    \input{../sympy/motzkin/motzkin-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/motzkin/motzkin-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/motzkin/motzkin-variant-t-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/motzkin/motzkin-variant-t-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/motzkin/motzkin-variant-t-perp-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    \input{../sympy/motzkin/motzkin-variant-t-diamond-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure}
    
    \input{../sympy/motzkin/Motzkin-standard-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/motzkin/Motzkin-inverse-handle-negatives-plain-colouring-127-rows-mod2-partitioning-include-figure.tex}

    \section{Delannoy}

    % mod 2
    Expansion of Riordan array $\mathcal{D}$:
    \input{../sympy/delannoy/delannoy-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}
    Expansion of Riordan array $\mathcal{D}^{-1}$:
    \input{../sympy/delannoy/delannoy-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-matrix.tex}

    \input{../sympy/delannoy/delannoy-standard-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}
    \input{../sympy/delannoy/delannoy-inverse-ignore-negatives-centered-colouring-127-rows-mod2-partitioning-include-figure.tex}

    % mod 3
    % the following matrices are identical to the previous ones
    %\input{../sympy/delannoy/delannoy-standard-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-matrix.tex}
    %\input{../sympy/delannoy/delannoy-inverse-ignore-negatives-centered-colouring-127-rows-mod3-partitioning-include-matrix.tex}

    \input{../sympy/delannoy/delannoy-standard-handle-negatives-centered-colouring-127-rows-multiples-of-3-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-standard-handle-negatives-centered-colouring-127-rows-multiples-of-5-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-standard-handle-negatives-centered-colouring-127-rows-multiples-of-7-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-standard-handle-negatives-centered-colouring-127-rows-multiples-of-11-partitioning-include-figure}

    \input{../sympy/delannoy/delannoy-inverse-handle-negatives-centered-colouring-127-rows-multiples-of-3-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-inverse-handle-negatives-centered-colouring-127-rows-multiples-of-5-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-inverse-handle-negatives-centered-colouring-127-rows-multiples-of-7-partitioning-include-figure}
    \input{../sympy/delannoy/delannoy-inverse-handle-negatives-centered-colouring-127-rows-multiples-of-11-partitioning-include-figure}

    % bib stuff
    %\nocite{*}
    %\addtocontents{toc}{\protect\vspace{\beforebibskip}}
    %\addcontentsline{toc}{section}{\refname}    
    %\bibliographystyle{plain}
    %\bibliography{../Bibliography}
\end{document}
